<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            direction: rtl;
        }

        /* Ø®Ù„ÙÙŠØ© Ø­ÙŠØ© Ù…ØªØ­Ø±ÙƒØ© */
        .live-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(45deg, #ff6b9d, #ffa726, #ab47bc, #42a5f5);
            background-size: 400% 400%;
            animation: modernGradientFlow 15s ease infinite;
        }

        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 20% 50%, rgba(255, 107, 157, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(171, 71, 188, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 40% 80%, rgba(66, 165, 245, 0.3) 0%, transparent 50%);
            animation: modernBackgroundPulse 8s ease-in-out infinite;
        }

        /* Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ */
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© */
        .header {
            padding: 2rem;
            margin: 1rem;
            position: relative;
            overflow: hidden;
        }

        .logo-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #ff6b9d, #ffa726);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: 0 0 30px rgba(255, 107, 157, 0.5);
            animation: logoPulse 3s ease-in-out infinite;
        }

        .main-title {
            text-align: center;
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ff6b9d, #ffa726, #ab47bc, #42a5f5);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: animatedTitle 5s ease infinite;
            margin: 1rem 0;
        }

        .subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2rem;
        }

        .header-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin: 2rem 0;
        }

        .info-card {
            padding: 1rem 2rem;
            text-align: center;
            color: white;
            font-weight: 500;
        }

        .stars-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .star-card {
            padding: 1.5rem;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .star-card:nth-child(1) { background: linear-gradient(135deg, #ff6b9d, #ff8a80); }
        .star-card:nth-child(2) { background: linear-gradient(135deg, #ffa726, #ffcc02); }
        .star-card:nth-child(3) { background: linear-gradient(135deg, #ab47bc, #e1bee7); }
        .star-card:nth-child(4) { background: linear-gradient(135deg, #42a5f5, #81d4fa); }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ */
        .navigation {
            position: sticky;
            top: 0;
            z-index: 100;
            margin: 0 1rem;
            padding: 1rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .nav-button {
            padding: 1rem 2rem;
            border: none;
            border-radius: 15px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #ff6b9d, #ffa726);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 107, 157, 0.4);
        }

        .nav-button.active {
            background: linear-gradient(45deg, #42a5f5, #ab47bc);
            box-shadow: 0 10px 25px rgba(66, 165, 245, 0.4);
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .section.active {
            display: block;
        }

        /* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ± */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            padding: 1.5rem;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª */
        .teachers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .teacher-card {
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ± */
        .teacher-card.present {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.3), rgba(129, 199, 132, 0.2)) !important;
            border-color: rgba(76, 175, 80, 0.5);
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.3);
        }

        .teacher-card.absent {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.3), rgba(229, 115, 115, 0.2)) !important;
            border-color: rgba(244, 67, 54, 0.5);
            box-shadow: 0 0 20px rgba(244, 67, 54, 0.3);
        }

        .teacher-card.late {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.3), rgba(255, 183, 77, 0.2)) !important;
            border-color: rgba(255, 152, 0, 0.5);
            box-shadow: 0 0 20px rgba(255, 152, 0, 0.3);
        }

        .teacher-card.excused {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.3), rgba(100, 181, 246, 0.2)) !important;
            border-color: rgba(33, 150, 243, 0.5);
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.3);
        }

        .teacher-card.not-recorded {
            background: linear-gradient(135deg, rgba(158, 158, 158, 0.3), rgba(189, 189, 189, 0.2)) !important;
            border-color: rgba(158, 158, 158, 0.5);
            box-shadow: 0 0 20px rgba(158, 158, 158, 0.2);
        }

        .teacher-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b9d, #ffa726);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin: 0 auto 1rem;
        }

        .teacher-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .teacher-class {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1rem;
        }

        .attendance-status {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .status-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 10px;
            font-family: 'Tajawal', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .status-btn.present { background: #4caf50; }
        .status-btn.absent { background: #f44336; }
        .status-btn.late { background: #ff9800; }
        .status-btn.excused { background: #2196f3; }
        
        .status-btn.active {
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© */
        .teacher-controls {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 8px;
            font-family: 'Tajawal', sans-serif;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .control-btn.edit { background: #9c27b0; }
        .control-btn.camera { background: #607d8b; }
        .control-btn.reset { background: #795548; }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØµÙˆÙŠØ± */
        .camera-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            flex-direction: column;
        }

        .camera-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 90%;
            max-height: 90%;
            position: relative;
            text-align: center;
        }

        .camera-video {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .camera-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .camera-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .camera-btn.capture { background: #4caf50; }
        .camera-btn.close { background: #f44336; }
        .camera-btn.switch { background: #2196f3; }

        .camera-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø© */
        .captured-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            margin: 1rem 0;
            border: 3px solid #4caf50;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙÙˆÙ */
        .classes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .class-card {
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .class-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 1rem;
        }

        .total-points {
            font-size: 2rem;
            font-weight: 900;
            color: #ffa726;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .criteria-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .criteria-name {
            color: white;
            font-weight: 500;
        }

        .points-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .point-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 50%;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .point-btn.minus { background: #f44336; }
        .point-btn.plus { background: #4caf50; }

        .points-display {
            color: white;
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        /* ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        .admin-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 15px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .admin-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .admin-tab.active {
            background: linear-gradient(45deg, #42a5f5, #ab47bc);
            box-shadow: 0 8px 20px rgba(66, 165, 245, 0.4);
        }

        .admin-tab-content {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .admin-tab-content.active {
            display: block;
        }

        /* Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª */
        .certificate-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .certificate-preview {
            width: 90%;
            max-width: 900px;
            max-height: 90%;
            background: white;
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            overflow-y: auto;
        }

        .certificate-canvas {
            width: 100%;
            max-width: 700px;
            height: auto;
            border: 3px solid #ffd700;
            border-radius: 15px;
            margin: 0 auto;
            display: block;
        }

        .certificate-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .certificate-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .certificate-btn.download { background: #4caf50; }
        .certificate-btn.print { background: #2196f3; }
        .certificate-btn.close { background: #f44336; }

        .certificate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .password-input {
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            margin: 1rem;
            background: rgba(255, 255, 255, 0.9);
            text-align: center;
        }

        /* Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        @keyframes modernGradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes modernBackgroundPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        @keyframes logoPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(255, 107, 157, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 50px rgba(255, 107, 157, 0.8); }
        }

        @keyframes animatedTitle {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .main-title { font-size: 2.5rem; }
            .header-info { flex-direction: column; gap: 1rem; }
            .navigation { flex-direction: column; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .teachers-grid { grid-template-columns: 1fr; }
            .classes-grid { grid-template-columns: 1fr; }
            .admin-tabs { flex-direction: column; }
            .admin-tab { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø­ÙŠØ© -->
    <div class="live-background"></div>
    <div class="background-overlay"></div>

    <!-- Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© -->
    <header class="header glass-morphism">
        <div class="logo-container">
            <div class="logo" id="logo1">
                ğŸ“š
            </div>
            <div class="logo" id="logo2">
                ğŸ«
            </div>
        </div>
        
        <h1 class="main-title">Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</h1>
        <p class="subtitle" id="subtitle">Ø§Ù†Ø¶Ø¨Ø§Ø· ÙŠØ¹ÙƒØ³ ÙˆØ¹ÙŠÙ‹Ø§ ÙˆÙ†Ø¸Ø§Ù… ÙŠØµÙ†Ø¹ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„</p>
        
        <div class="header-info">
            <div class="info-card glass-morphism">
                <div id="schoolInfo">Ù…Ø¯Ø±Ø³Ø© Ø£Ù… Ù…Ø§Ù„Ùƒ Ø§Ù„Ø§Ù†ØµØ§Ø±ÙŠØ© Ù„Ù„Ø¨Ù†Ø§Øª</div>
                <div id="principalInfo">Ø§Ù„Ù…Ø¯ÙŠØ±Ø©: Ø£.Ø£Ø­Ù„Ø§Ù… Ø¨Ù†Øª Ø¹Ù„ÙŠ Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©</div>
                <div id="currentDateTime"></div>
            </div>
        </div>
        
        <div class="stars-summary">
            <div class="star-card glass-morphism">
                <h3>ğŸŒŸ Ù†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…</h3>
                <p id="starOfDay">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯</p>
            </div>
            <div class="star-card glass-morphism">
                <h3>â­ Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</h3>
                <p id="queueStarDay">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯</p>
            </div>
            <div class="star-card glass-morphism">
                <h3>ğŸ† Ù†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±</h3>
                <p id="starOfMonth">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯</p>
            </div>
            <div class="star-card glass-morphism">
                <h3>ğŸ‘‘ Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ù„Ù„Ø´Ù‡Ø±</h3>
                <p id="queueStarMonth">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯</p>
            </div>
        </div>
    </header>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="navigation glass-morphism">
        <button class="nav-button active" onclick="showSection('attendance')">
            ğŸ‘¥ Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
        </button>
        <button class="nav-button" onclick="showSection('queue-star')">
            â­ Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ±
        </button>
        <button class="nav-button" onclick="showSection('admin')">
            âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        </button>
    </nav>

    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª -->
    <div id="certificateModal" class="certificate-modal">
        <div class="certificate-preview">
            <canvas id="certificateCanvas" class="certificate-canvas" width="800" height="600"></canvas>
            <div class="certificate-controls">
                <button class="certificate-btn download" onclick="downloadCertificate()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ PNG</button>
                <button class="certificate-btn print" onclick="printCertificate()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                <button class="certificate-btn close" onclick="closeCertificateModal()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØµÙˆÙŠØ± -->
    <div id="cameraModal" class="camera-modal">
        <div class="camera-container">
            <h3 style="color: #333; margin-bottom: 1rem;" id="cameraTitle">ØªØµÙˆÙŠØ± Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</h3>
            <video id="cameraVideo" class="camera-video" autoplay playsinline></video>
            <canvas id="cameraCanvas" style="display: none;"></canvas>
            <img id="capturedImage" class="captured-image" style="display: none;">
            
            <div class="camera-controls">
                <button class="camera-btn capture" onclick="capturePhoto()" id="captureBtn">ğŸ“¸ Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø©</button>
                <button class="camera-btn switch" onclick="switchCamera()" id="switchBtn">ğŸ”„ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
                <button class="camera-btn capture" onclick="savePhoto()" id="saveBtn" style="display: none; background: #ff9800;">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©</button>
                <button class="camera-btn capture" onclick="retakePhoto()" id="retakeBtn" style="display: none; background: #9c27b0;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ø§Ø·</button>
                <button class="camera-btn close" onclick="closeCameraModal()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="main-content">
        <!-- Ù‚Ø³Ù… Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª -->
        <section id="attendance" class="section active">
            <div class="stats-grid">
                <div class="stat-card glass-morphism" style="background: linear-gradient(135deg, #4caf50, #81c784);">
                    <div class="stat-number" id="presentCount">0</div>
                    <div class="stat-label">Ø­Ø§Ø¶Ø±Ø§Øª</div>
                </div>
                <div class="stat-card glass-morphism" style="background: linear-gradient(135deg, #f44336, #e57373);">
                    <div class="stat-number" id="absentCount">0</div>
                    <div class="stat-label">ØºØ§Ø¦Ø¨Ø§Øª</div>
                </div>
                <div class="stat-card glass-morphism" style="background: linear-gradient(135deg, #ff9800, #ffb74d);">
                    <div class="stat-number" id="notRecordedCount">0</div>
                    <div class="stat-label">Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</div>
                </div>
                <div class="stat-card glass-morphism" style="background: linear-gradient(135deg, #2196f3, #64b5f6);">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                </div>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª -->
            <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;" id="presentTeachersSection">
                <h3 style="color: white; text-align: center; margin-bottom: 1rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">âœ…</span>
                    Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…
                    <span id="presentTeachersCount" style="background: #4caf50; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.9rem; margin-right: 0.5rem;">0</span>
                </h3>
                <div id="presentTeachersList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; text-align: center;">
                    <div style="color: rgba(255,255,255,0.7); font-style: italic; grid-column: 1 / -1;">Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ø­Ø¶ÙˆØ± Ø¨Ø¹Ø¯</div>
                </div>
            </div>
            
            <div class="teachers-grid" id="teachersGrid">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ù‡Ù†Ø§ -->
            </div>
        </section>

        <!-- Ù‚Ø³Ù… Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± -->
        <section id="queue-star" class="section">
            <div class="classes-grid" id="classesGrid">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙÙˆÙ Ù‡Ù†Ø§ -->
            </div>
        </section>

        <!-- Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <section id="admin" class="section">
            <div class="glass-morphism" style="padding: 2rem; text-align: center;">
                <h2 style="color: white; margin-bottom: 2rem;">ğŸ” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                <div id="adminLogin">
                    <input type="password" id="adminPassword" class="password-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                    <br>
                    <button class="nav-button" onclick="checkAdminPassword()">Ø¯Ø®ÙˆÙ„</button>
                </div>
                <div id="adminPanel" style="display: none;">
                    <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
                    <div class="admin-tabs">
                        <button class="admin-tab active" onclick="showAdminTab('teachers')">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</button>
                        <button class="admin-tab" onclick="showAdminTab('stars')">â­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¬ÙˆÙ…</button>
                        <button class="admin-tab" onclick="showAdminTab('certificates')">ğŸ† Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</button>
                        <button class="admin-tab" onclick="showAdminTab('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                        <button class="admin-tab" onclick="showAdminTab('data')">ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª -->
                    <div id="adminTab-teachers" class="admin-tab-content active">
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                <input type="text" id="newTeacherName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©" class="password-input" style="margin: 0;">
                                <input type="text" id="newTeacherClass" placeholder="Ø§Ù„ØµÙ" class="password-input" style="margin: 0;">
                                <button class="nav-button" onclick="addTeacher()" style="margin: 0;">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø©</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ“Š Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„Ù„Ù…Ø¹Ù„Ù…Ø§Øª</h4>
                            <input type="file" id="teachersExcelFile" accept=".xlsx,.xls,.csv" class="password-input" style="margin-bottom: 1rem;">
                            <button class="nav-button" onclick="uploadTeachersExcel()">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</button>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ« Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„Ù„ØµÙÙˆÙ</h4>
                            <input type="file" id="classesExcelFile" accept=".xlsx,.xls,.csv" class="password-input" style="margin-bottom: 1rem;">
                            <button class="nav-button" onclick="uploadClassesExcel()">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„ØµÙÙˆÙ</button>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸŒ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Google Sheets</h4>
                            <div style="padding: 1rem; background: rgba(76, 175, 80, 0.2); border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3); margin-bottom: 1rem;">
                                <div style="color: white; text-align: center;">
                                    <div style="font-size: 1.2rem; margin-bottom: 0.5rem;">âœ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…ÙØ¹Ù„</div>
                                    <div style="font-size: 0.9rem; opacity: 0.9;">ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø´ÙŠØª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                                    <div style="font-size: 0.9rem; opacity: 0.9;">ÙˆÙŠØªÙ… ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©</div>
                                    <div style="font-size: 0.8rem; opacity: 0.8; margin-top: 0.5rem;">Ø§Ù„Ø¥ØµØ¯Ø§Ø± 24 - ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª</div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                <button class="status-btn" style="background: #2196f3;" onclick="autoImportFromSheet()">ğŸ”„ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ</button>
                                <button class="status-btn" style="background: #9c27b0;" onclick="loadDefaultData()">ğŸ“‹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</button>
                                <button class="status-btn" style="background: #e91e63;" onclick="debugSheetData()">ğŸ” ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                                <button class="status-btn" style="background: #4caf50;" onclick="showImportedData()">ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</button>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 1rem; color: white; font-size: 0.9rem;">
                                <div style="margin-bottom: 0.5rem;"><strong>ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong></div>
                                <div style="word-break: break-all; font-family: monospace; background: rgba(0,0,0,0.3); padding: 0.5rem; border-radius: 5px;" id="currentSheetUrl">
                                    https://docs.google.com/spreadsheets/d/e/2PACX-1vTAQSZ9MELNNPjoTsx_Uysz2s0e6eF-Ta9RjvAakDjp-w4VtLMxXYcQ_H5bBmhP8w/pubhtml
                                </div>
                            </div>
                        </div>

                        <!-- Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø© -->
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;" id="importedDataSection">
                            <h4 style="color: white; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø© Ù…Ù† Ø§Ù„Ø¥ÙƒØ³Ù„
                                <span id="importedDataCount" style="background: #4caf50; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">0 Ù…Ø¹Ù„Ù…Ø©</span>
                            </h4>
                            
                            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                                <div style="text-align: center; padding: 1rem; background: rgba(76, 175, 80, 0.2); border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3);">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #4caf50;" id="totalImportedTeachers">24</div>
                                    <div style="color: white; font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(33, 150, 243, 0.2); border-radius: 10px; border: 1px solid rgba(33, 150, 243, 0.3);">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #2196f3;" id="totalImportedClasses">24</div>
                                    <div style="color: white; font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙÙˆÙ</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(255, 152, 0, 0.2); border-radius: 10px; border: 1px solid rgba(255, 152, 0, 0.3);">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #ff9800;" id="lastUpdateTime">--:--</div>
                                    <div style="color: white; font-size: 0.9rem;">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
                                </div>
                            </div>

                            <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                            <div style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                                <button class="status-btn active" style="background: #2196f3;" onclick="showDataTab('teachers')" id="teachersTab">ğŸ‘¥ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</button>
                                <button class="status-btn" style="background: #9c27b0;" onclick="showDataTab('classes')" id="classesTab">ğŸ« Ø§Ù„ØµÙÙˆÙ</button>
                                <button class="status-btn" style="background: #4caf50;" onclick="showDataTab('summary')" id="summaryTab">ğŸ“‹ Ù…Ù„Ø®Øµ</button>
                            </div>

                            <!-- Ù…Ø­ØªÙˆÙ‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª -->
                            <div id="teachersDataTab" class="data-tab-content">
                                <h5 style="color: white; margin-bottom: 1rem; text-align: center;">ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</h5>
                                <div id="importedTeachersList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; max-height: 400px; overflow-y: auto; padding: 0.5rem;">
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§ -->
                                </div>
                            </div>

                            <!-- Ù…Ø­ØªÙˆÙ‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØµÙÙˆÙ -->
                            <div id="classesDataTab" class="data-tab-content" style="display: none;">
                                <h5 style="color: white; margin-bottom: 1rem; text-align: center;">ğŸ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</h5>
                                <div id="importedClassesList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; max-height: 400px; overflow-y: auto; padding: 0.5rem;">
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§ -->
                                </div>
                            </div>

                            <!-- Ù…Ø­ØªÙˆÙ‰ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ù„Ø®Øµ -->
                            <div id="summaryDataTab" class="data-tab-content" style="display: none;">
                                <h5 style="color: white; margin-bottom: 1rem; text-align: center;">ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</h5>
                                <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 1rem; color: white; font-size: 0.9rem;">
                                    <div id="dataSummary">
                                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ù„Ø®Øµ Ù‡Ù†Ø§ -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ”§ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h4>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="status-btn" style="background: #4caf50;" onclick="markAllPresent()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙƒÙ„ Ø­Ø§Ø¶Ø±</button>
                                <button class="status-btn" style="background: #f44336;" onclick="resetAllAttendance()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„</button>
                                <button class="status-btn" style="background: #2196f3;" onclick="copyTeachersData()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¬ÙˆÙ… -->
                    <div id="adminTab-stars" class="admin-tab-content">
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸŒŸ Ù†Ø¬ÙˆÙ… Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…:</label>
                                    <select id="starOfDaySelect" class="password-input" style="margin: 0;" onchange="updateStarOfDay()">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:</label>
                                    <select id="starOfWeekSelect" class="password-input" style="margin: 0;" onchange="updateStarOfWeek()">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±:</label>
                                    <select id="starOfMonthSelect" class="password-input" style="margin: 0;" onchange="updateStarOfMonth()">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">â­ Ù†Ø¬ÙˆÙ… Ø§Ù„ØµÙÙˆÙ (Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ±)</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…:</label>
                                    <select id="queueStarDaySelect" class="password-input" style="margin: 0;" onchange="updateQueueStarDay()">
                                        <option value="">ØªØ­Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</option>
                                    </select>
                                    <small style="color: rgba(255,255,255,0.7);">ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·</small>
                                </div>
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹:</label>
                                    <select id="queueStarWeekSelect" class="password-input" style="margin: 0;" onchange="updateQueueStarWeek()">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ù„Ù„Ø´Ù‡Ø±:</label>
                                    <select id="queueStarMonthSelect" class="password-input" style="margin: 0;" onchange="updateQueueStarMonth()">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ“Š Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</h4>
                            <div style="color: white; text-align: right;">
                                <p>â€¢ Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ: ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„ØµÙ Ø§Ù„Ø­Ø§ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·</p>
                                <p>â€¢ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·: Ø§Ù„Ø³Ø±Ø¹Ø© + Ø§Ù„Ù‡Ø¯ÙˆØ¡ + Ø§Ù„Ù†Ø¸Ø§ÙØ©</p>
                                <p>â€¢ ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·</p>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª -->
                    <div id="adminTab-certificates" class="admin-tab-content">
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ† Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <button class="nav-button" onclick="openCertificatePreview('teacher-day')">ğŸŒŸ Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…</button>
                                <button class="nav-button" onclick="openCertificatePreview('teacher-week')">â­ Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
                                <button class="nav-button" onclick="openCertificatePreview('teacher-month')">ğŸ‘‘ Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±</button>
                                <button class="nav-button" onclick="openCertificatePreview('attendance')">ğŸ“‹ Ø´Ù‡Ø§Ø¯Ø© Ø­Ø¶ÙˆØ± Ù…Ø«Ø§Ù„ÙŠ</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">â­ Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ØµÙÙˆÙ</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <button class="nav-button" onclick="openCertificatePreview('queue-day')">ğŸ† Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
                                <button class="nav-button" onclick="openCertificatePreview('queue-week')">ğŸ¥‡ Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</button>
                                <button class="nav-button" onclick="openCertificatePreview('queue-month')">ğŸ‘‘ Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ</button>
                                <button class="nav-button" onclick="openCertificatePreview('class-excellence')">ğŸŒŸ Ø´Ù‡Ø§Ø¯Ø© ØªÙ…ÙŠØ² Ø§Ù„ØµÙ</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                <input type="text" id="customRecipient" placeholder="Ø§Ø³Ù… Ù…Ø®ØµØµ Ù„Ù„Ù…Ø³ØªÙ„Ù…" class="password-input" style="margin: 0;">
                                <input type="text" id="customReason" placeholder="Ø³Ø¨Ø¨ Ù…Ø®ØµØµ Ù„Ù„Ø´Ù‡Ø§Ø¯Ø©" class="password-input" style="margin: 0;">
                            </div>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="status-btn" style="background: #9c27b0;" onclick="previewCustomCertificate()">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø®ØµØµØ©</button>
                                <button class="status-btn" style="background: #795548;" onclick="printAllCertificates()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</button>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
                    <div id="adminTab-settings" class="admin-tab-content">
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ–¼ï¸ Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙŠÙ…Ù†:</label>
                                    <input type="file" id="schoolLogo1" accept="image/*" class="password-input" style="margin: 0; margin-bottom: 1rem;" onchange="uploadLogo(1)">
                                    <div id="logo1Preview" style="width: 100px; height: 100px; border: 2px dashed rgba(255,255,255,0.3); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto; font-size: 3rem;">
                                        ğŸ“š
                                    </div>
                                </div>
                                <div>
                                    <label style="color: white; display: block; margin-bottom: 0.5rem;">Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙŠØ³Ø±:</label>
                                    <input type="file" id="schoolLogo2" accept="image/*" class="password-input" style="margin: 0; margin-bottom: 1rem;" onchange="uploadLogo(2)">
                                    <div id="logo2Preview" style="width: 100px; height: 100px; border: 2px dashed rgba(255,255,255,0.3); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto; font-size: 3rem;">
                                        ğŸ«
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                <input type="text" id="schoolName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" class="password-input" style="margin: 0;" value="Ù…Ø¯Ø±Ø³Ø© Ø£Ù… Ù…Ø§Ù„Ùƒ Ø§Ù„Ø§Ù†ØµØ§Ø±ÙŠØ© Ù„Ù„Ø¨Ù†Ø§Øª">
                                <input type="text" id="principalName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±Ø©" class="password-input" style="margin: 0;" value="Ø£.Ø£Ø­Ù„Ø§Ù… Ø¨Ù†Øª Ø¹Ù„ÙŠ Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©">
                                <input type="text" id="systemSubtitle" class="password-input" style="margin: 0;" value="Ø§Ù†Ø¶Ø¨Ø§Ø· ÙŠØ¹ÙƒØ³ ÙˆØ¹ÙŠÙ‹Ø§ ÙˆÙ†Ø¸Ø§Ù… ÙŠØµÙ†Ø¹ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ±Ø¹ÙŠ">
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ” ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <input type="password" id="currentPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©" class="password-input" style="margin: 0;">
                                <input type="password" id="newSystemPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" class="password-input" style="margin: 0;">
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <button class="nav-button" onclick="updateSystemSettings()">ğŸ’¾ Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                    <div id="adminTab-data" class="admin-tab-content">
                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ“Š ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                <select id="reportPeriod" class="password-input" style="margin: 0;">
                                    <option value="daily">ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ</option>
                                    <option value="weekly">ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option>
                                    <option value="monthly">ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ</option>
                                </select>
                                <select id="reportType" class="password-input" style="margin: 0;">
                                    <option value="attendance">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±</option>
                                    <option value="points">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‚Ø§Ø·</option>
                                    <option value="stars">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¬ÙˆÙ…</option>
                                    <option value="complete">ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„</option>
                                </select>
                            </div>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="status-btn" style="background: #4caf50;" onclick="exportReport('excel')">ğŸ“Š Excel</button>
                                <button class="status-btn" style="background: #f44336;" onclick="exportReport('pdf')">ğŸ“„ PDF</button>
                                <button class="status-btn" style="background: #ff9800;" onclick="exportReport('image')">ğŸ–¼ï¸ ØµÙˆØ±Ø©</button>
                                <button class="status-btn" style="background: #2196f3;" onclick="exportReport('all')">ğŸ“¦ ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©</h4>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                <button class="status-btn" style="background: #795548;" onclick="backupData()">ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</button>
                                <input type="file" id="restoreFile" accept=".json" style="display: none;" onchange="restoreData()">
                                <button class="status-btn" style="background: #607d8b;" onclick="document.getElementById('restoreFile').click()">ğŸ“¥ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="status-btn" style="background: #ff5722;" onclick="clearAttendanceData()">Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±</button>
                                <button class="status-btn" style="background: #e91e63;" onclick="clearPointsData()">Ù…Ø³Ø­ Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙÙˆÙ</button>
                                <button class="status-btn" style="background: #f44336;" onclick="resetSystem()">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                            </div>
                        </div>

                        <div class="glass-morphism" style="padding: 1.5rem;">
                            <h4 style="color: white; margin-bottom: 1rem;">ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
                            <div id="systemStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px; color: white;">
                                    <div style="font-size: 2rem; font-weight: bold;" id="attendanceRate">0%</div>
                                    <div>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px; color: white;">
                                    <div style="font-size: 2rem; font-weight: bold;" id="totalTeachers">0</div>
                                    <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px; color: white;">
                                    <div style="font-size: 2rem; font-weight: bold;" id="totalClasses">0</div>
                                    <div>Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px; color: white;">
                                    <div style="font-size: 2rem; font-weight: bold;" id="systemUptime">0</div>
                                    <div>ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ (Ø¯Ù‚ÙŠÙ‚Ø©)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        let teachers = [];
        let classes = [];
        let stars = {
            teacherDay: null,
            teacherWeek: null,
            teacherMonth: null,
            queueDay: null,
            queueWeek: null,
            queueMonth: null
        };
        let settings = {
            adminPassword: '123456',
            schoolName: 'Ù…Ø¯Ø±Ø³Ø© Ø£Ù… Ù…Ø§Ù„Ùƒ Ø§Ù„Ø§Ù†ØµØ§Ø±ÙŠØ© Ù„Ù„Ø¨Ù†Ø§Øª',
            principalName: 'Ø£.Ø£Ø­Ù„Ø§Ù… Ø¨Ù†Øª Ø¹Ù„ÙŠ Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©',
            subtitle: 'Ø§Ù†Ø¶Ø¨Ø§Ø· ÙŠØ¹ÙƒØ³ ÙˆØ¹ÙŠÙ‹Ø§ ÙˆÙ†Ø¸Ø§Ù… ÙŠØµÙ†Ø¹ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„',
            logo1: 'ğŸ“š',
            logo2: 'ğŸ«'
        };
        let startTime = Date.now();
        let currentCertificateType = '';
        let lastImportedData = null;
        let autoUpdateInterval = null;
        let googleSheetsUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTAQSZ9MELNNPjoTsx_Uysz2s0e6eF-Ta9RjvAakDjp-w4VtLMxXYcQ_H5bBmhP8w/pubhtml';

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
        function updateDateTime() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'Asia/Riyadh'
            };
            
            const arabicDate = now.toLocaleDateString('ar-SA', options);
            const hijriDate = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }).format(now);
            
            document.getElementById('currentDateTime').innerHTML = `
                <div>${arabicDate}</div>
                <div style="font-size: 0.9rem; opacity: 0.8;">${hijriDate}</div>
            `;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Ø§Ù„Ø¥ÙƒØ³Ù„ (Ø§Ù„Ø¥ØµØ¯Ø§Ø± 24)
        function loadSampleData() {
            teachers = [
                { id: 1, name: 'Ø£. Ø£Ù…Ù„ Ø¨Ù†Øª Ø³Ø§Ù„Ù… Ø§Ù„Ø­Ø§Ø±Ø«ÙŠØ©', class: '1/1', status: 'not-recorded', attendanceTime: null },
                { id: 2, name: 'Ø£. ÙØ§Ø·Ù…Ø© Ø¨Ù†Øª Ù…Ø­Ù…Ø¯ Ø§Ù„ØºØ§ÙØ±ÙŠØ©', class: '1/2', status: 'not-recorded', attendanceTime: null },
                { id: 3, name: 'Ø£. Ù…Ø±ÙŠÙ… Ø¨Ù†Øª Ø£Ø­Ù…Ø¯ Ø§Ù„ÙƒÙ†Ø¯ÙŠØ©', class: '1/3', status: 'not-recorded', attendanceTime: null },
                { id: 4, name: 'Ø£. Ø¹Ø§Ø¦Ø´Ø© Ø¨Ù†Øª Ø¹Ù„ÙŠ Ø§Ù„Ø´Ø§Ù…Ø³ÙŠØ©', class: '2/1', status: 'not-recorded', attendanceTime: null },
                { id: 5, name: 'Ø£. Ø®Ø¯ÙŠØ¬Ø© Ø¨Ù†Øª ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ø¨Ø±ÙŠØ©', class: '2/2', status: 'not-recorded', attendanceTime: null },
                { id: 6, name: 'Ø£. Ø²ÙŠÙ†Ø¨ Ø¨Ù†Øª Ø­Ù…Ø¯ Ø§Ù„Ù‡Ù†Ø§Ø¦ÙŠØ©', class: '2/3', status: 'not-recorded', attendanceTime: null },
                { id: 7, name: 'Ø£. Ø±Ù‚ÙŠØ© Ø¨Ù†Øª Ø³Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø¹Ù…Ø±ÙŠØ©', class: '3/1', status: 'not-recorded', attendanceTime: null },
                { id: 8, name: 'Ø£. Ø­ÙØµØ© Ø¨Ù†Øª Ø±Ø§Ø´Ø¯ Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ©', class: '3/2', status: 'not-recorded', attendanceTime: null },
                { id: 9, name: 'Ø£. Ø£Ø³Ù…Ø§Ø¡ Ø¨Ù†Øª Ø®Ø§Ù„Ø¯ Ø§Ù„Ø±ÙˆØ§Ø­ÙŠØ©', class: '3/3', status: 'not-recorded', attendanceTime: null },
                { id: 10, name: 'Ø£. Ø³Ø¹Ø§Ø¯ Ø¨Ù†Øª Ù†Ø§ØµØ± Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠØ©', class: '4/1', status: 'not-recorded', attendanceTime: null },
                { id: 11, name: 'Ø£. Ù†ÙˆØ±Ø© Ø¨Ù†Øª Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø³ÙŠØ§Ø¨ÙŠØ©', class: '4/2', status: 'not-recorded', attendanceTime: null },
                { id: 12, name: 'Ø£. Ù‡Ø¯Ù‰ Ø¨Ù†Øª Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„ÙØ§Ø±Ø³ÙŠØ©', class: '4/3', status: 'not-recorded', attendanceTime: null },
                { id: 13, name: 'Ø£. Ù„ÙŠÙ„Ù‰ Ø¨Ù†Øª Ø¹Ù…Ø± Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠØ©', class: '5/1', status: 'not-recorded', attendanceTime: null },
                { id: 14, name: 'Ø£. ØµÙÙŠØ© Ø¨Ù†Øª Ø­Ø³Ù† Ø§Ù„Ø±Ø­Ø¨ÙŠØ©', class: '5/2', status: 'not-recorded', attendanceTime: null },
                { id: 15, name: 'Ø£. Ø¬Ù…ÙŠÙ„Ø© Ø¨Ù†Øª Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„ØºÙŠØ«ÙŠØ©', class: '5/3', status: 'not-recorded', attendanceTime: null },
                { id: 16, name: 'Ø£. ÙˆØ±Ø¯Ø© Ø¨Ù†Øª Ù…Ø­Ù…ÙˆØ¯ Ø§Ù„Ø­Ø¨Ø³ÙŠØ©', class: '6/1', status: 'not-recorded', attendanceTime: null },
                { id: 17, name: 'Ø£. Ù†Ø¬Ø§Ø© Ø¨Ù†Øª Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø´ÙƒÙŠÙ„ÙŠØ©', class: '6/2', status: 'not-recorded', attendanceTime: null },
                { id: 18, name: 'Ø£. Ø³Ù„Ù…Ù‰ Ø¨Ù†Øª Ø·Ø§Ù„Ø¨ Ø§Ù„Ù‡Ø§Ø´Ù…ÙŠØ©', class: '6/3', status: 'not-recorded', attendanceTime: null },
                { id: 19, name: 'Ø£. Ù…Ù†Ù‰ Ø¨Ù†Øª Ø¬Ø§Ø¨Ø± Ø§Ù„Ø¹Ø§Ù…Ø±ÙŠØ©', class: '7/1', status: 'not-recorded', attendanceTime: null },
                { id: 20, name: 'Ø£. Ù‡Ù†Ø§Ø¡ Ø¨Ù†Øª ÙƒØ±ÙŠÙ… Ø§Ù„ØµÙˆØ§ÙÙŠØ©', class: '7/2', status: 'not-recorded', attendanceTime: null },
                { id: 21, name: 'Ø£. Ø±Ø­Ù…Ø© Ø¨Ù†Øª ÙÙ‡Ø¯ Ø§Ù„Ø¬Ù‡ÙˆØ±ÙŠØ©', class: '7/3', status: 'not-recorded', attendanceTime: null },
                { id: 22, name: 'Ø£. Ø´ÙŠÙ…Ø§Ø¡ Ø¨Ù†Øª Ø±Ø§Ø´Ø¯ Ø§Ù„Ù…Ù‚Ø¨Ø§Ù„ÙŠØ©', class: '8/1', status: 'not-recorded', attendanceTime: null },
                { id: 23, name: 'Ø£. Ø¥ÙŠÙ…Ø§Ù† Ø¨Ù†Øª Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø­Ø±Ø§ØµÙŠØ©', class: '8/2', status: 'not-recorded', attendanceTime: null },
                { id: 24, name: 'Ø£. Ù†Ø§Ø¯ÙŠØ© Ø¨Ù†Øª Ø®Ù„ÙØ§Ù† Ø§Ù„Ø¨ÙˆØ³Ø¹ÙŠØ¯ÙŠØ©', class: '8/3', status: 'not-recorded', attendanceTime: null }
            ];

            classes = [
                { id: 1, name: '1/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 2, name: '1/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 3, name: '1/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 4, name: '2/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 5, name: '2/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 6, name: '2/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 7, name: '3/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 8, name: '3/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 9, name: '3/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 10, name: '4/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 11, name: '4/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 12, name: '4/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 13, name: '5/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 14, name: '5/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 15, name: '5/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 16, name: '6/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 17, name: '6/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 18, name: '6/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 19, name: '7/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 20, name: '7/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 21, name: '7/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 22, name: '8/1', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 23, name: '8/2', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 },
                { id: 24, name: '8/3', speed: 0, quiet: 0, cleanliness: 0, soundLevel: 0, dailyPoints: 0, monthlyPoints: 0, total: 0 }
            ];

            renderTeachers();
            renderClasses();
            updateStats();
            updateStarSelects();
            updatePresentTeachersList();
        }

        // Ø¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
        function renderTeachers() {
            const grid = document.getElementById('teachersGrid');
            grid.innerHTML = '';
            
            teachers.forEach(teacher => {
                const card = document.createElement('div');
                card.className = `teacher-card glass-morphism ${teacher.status}`;
                
                card.innerHTML = `
                    <div class="teacher-avatar">${teacher.name.charAt(0)}</div>
                    <div class="teacher-name">${teacher.name}</div>
                    <div class="teacher-class">${teacher.class}</div>
                    <div class="attendance-status">
                        <button class="status-btn present ${teacher.status === 'present' ? 'active' : ''}" 
                                onclick="updateAttendance(${teacher.id}, 'present')">âœ… Ø­Ø§Ø¶Ø±Ø©</button>
                        <button class="status-btn absent ${teacher.status === 'absent' ? 'active' : ''}" 
                                onclick="updateAttendance(${teacher.id}, 'absent')">âŒ ØºØ§Ø¦Ø¨Ø©</button>
                        <button class="status-btn late ${teacher.status === 'late' ? 'active' : ''}" 
                                onclick="updateAttendance(${teacher.id}, 'late')">â° Ù…ØªØ£Ø®Ø±Ø©</button>
                        <button class="status-btn excused ${teacher.status === 'excused' ? 'active' : ''}" 
                                onclick="updateAttendance(${teacher.id}, 'excused')">ğŸ“‹ Ø¨Ø¹Ø°Ø±</button>
                    </div>
                    ${teacher.attendanceTime ? `<div style="text-align: center; color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 0.5rem;">
                        ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${teacher.attendanceTime}
                    </div>` : ''}
                    
                    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© -->
                    <div class="teacher-controls">
                        <button class="control-btn edit" onclick="editTeacherAttendance(${teacher.id})">
                            âœï¸ ØªØ¹Ø¯ÙŠÙ„
                        </button>
                        <button class="control-btn camera" onclick="openCamera(${teacher.id})">
                            ğŸ“¸ ØªØµÙˆÙŠØ±
                        </button>
                        <button class="control-btn reset" onclick="resetTeacherAttendance(${teacher.id})">
                            ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                        </button>
                    </div>
                    
                    ${teacher.photo ? `<div style="text-align: center; margin-top: 0.5rem;">
                        <img src="${teacher.photo}" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.5);" onclick="viewTeacherPhoto(${teacher.id})" title="Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©">
                    </div>` : ''}
                `;
                
                grid.appendChild(card);
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª
            updatePresentTeachersList();
        }

        // Ø¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙÙˆÙ
        function renderClasses() {
            const grid = document.getElementById('classesGrid');
            grid.innerHTML = '';
            
            classes.forEach(classItem => {
                const card = document.createElement('div');
                card.className = 'class-card glass-morphism';
                
                card.innerHTML = `
                    <div class="class-name">${classItem.name}</div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: #ffa726;">${classItem.dailyPoints || 0}</div>
                            <div style="color: white; font-size: 0.9rem;">Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: #42a5f5;">${classItem.monthlyPoints || 0}</div>
                            <div style="color: white; font-size: 0.9rem;">Ù†Ù‚Ø§Ø· Ø§Ù„Ø´Ù‡Ø±</div>
                        </div>
                    </div>
                    
                    <div class="criteria-row">
                        <span class="criteria-name">â­ Ø§Ù„Ù‡Ø¯ÙˆØ¡</span>
                        <div class="points-controls">
                            <button class="point-btn minus" onclick="updatePoints(${classItem.id}, 'quiet', -1)">-</button>
                            <span class="points-display">${classItem.quiet}</span>
                            <button class="point-btn plus" onclick="updatePoints(${classItem.id}, 'quiet', 1)">+</button>
                        </div>
                    </div>
                    
                    <div class="criteria-row">
                        <span class="criteria-name">âš¡ Ø³Ø±Ø¹Ø© Ø§Ù„Ø§ØµØ·ÙØ§Ù</span>
                        <div class="points-controls">
                            <button class="point-btn minus" onclick="updatePoints(${classItem.id}, 'speed', -1)">-</button>
                            <span class="points-display">${classItem.speed}</span>
                            <button class="point-btn plus" onclick="updatePoints(${classItem.id}, 'speed', 1)">+</button>
                        </div>
                    </div>
                    
                    <div class="criteria-row">
                        <span class="criteria-name">ğŸ”Š Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª</span>
                        <div class="points-controls">
                            <button class="point-btn minus" onclick="updatePoints(${classItem.id}, 'soundLevel', -1)">-</button>
                            <span class="points-display">${classItem.soundLevel || 0}</span>
                            <button class="point-btn plus" onclick="updatePoints(${classItem.id}, 'soundLevel', 1)">+</button>
                        </div>
                    </div>
                    
                    <div class="criteria-row">
                        <span class="criteria-name">ğŸ§¹ Ø§Ù„Ù†Ø¸Ø§ÙØ©</span>
                        <div class="points-controls">
                            <button class="point-btn minus" onclick="updatePoints(${classItem.id}, 'cleanliness', -1)">-</button>
                            <span class="points-display">${classItem.cleanliness}</span>
                            <button class="point-btn plus" onclick="updatePoints(${classItem.id}, 'cleanliness', 1)">+</button>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª
        function updatePresentTeachersList() {
            const presentTeachers = teachers.filter(t => t.status === 'present');
            const listContainer = document.getElementById('presentTeachersList');
            const countElement = document.getElementById('presentTeachersCount');
            
            countElement.textContent = presentTeachers.length;
            
            if (presentTeachers.length === 0) {
                listContainer.innerHTML = '<div style="color: rgba(255,255,255,0.7); font-style: italic; grid-column: 1 / -1;">Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ø­Ø¶ÙˆØ± Ø¨Ø¹Ø¯</div>';
            } else {
                listContainer.innerHTML = presentTeachers.map(teacher => `
                    <div style="background: rgba(76, 175, 80, 0.2); border: 1px solid rgba(76, 175, 80, 0.4); border-radius: 10px; padding: 1rem; color: white;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            <span style="font-size: 1.2rem;">âœ…</span>
                            ${teacher.name}
                        </div>
                        <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 0.5rem;">${teacher.class}</div>
                        <div style="font-size: 0.8rem; opacity: 0.8;">
                            ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ±: ${teacher.attendanceTime}
                        </div>
                    </div>
                `).join('');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
        function updateAttendance(teacherId, status) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (teacher) {
                teacher.status = status;
                teacher.attendanceTime = new Date().toLocaleTimeString('ar-SA');
                renderTeachers();
                updateStats();
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙ
        function updatePoints(classId, criteria, change) {
            const classItem = classes.find(c => c.id === classId);
            if (classItem) {
                // ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø®Ø§ØµÙŠØ©
                if (!classItem[criteria]) {
                    classItem[criteria] = 0;
                }
                
                classItem[criteria] = Math.max(0, classItem[criteria] + change);
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø´Ù‡Ø±ÙŠØ©
                const dailyTotal = (classItem.quiet || 0) + (classItem.speed || 0) + (classItem.soundLevel || 0) + (classItem.cleanliness || 0);
                classItem.dailyPoints = dailyTotal;
                
                // Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (ÙŠÙ…ÙƒÙ† ØªØ­Ø¯ÙŠØ«Ù‡Ø§ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ø­Ø³Ø§Ø¨Ù‡Ø§ ØªØ±Ø§ÙƒÙ…ÙŠØ§Ù‹)
                if (!classItem.monthlyPoints) {
                    classItem.monthlyPoints = 0;
                }
                classItem.monthlyPoints += change; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØºÙŠÙŠØ± Ù„Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                classItem.monthlyPoints = Math.max(0, classItem.monthlyPoints);
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„ØªØ±ØªÙŠØ¨
                classItem.total = dailyTotal;
                
                renderClasses();
                updateAutoQueueStar();
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function updateAutoQueueStar() {
            if (classes.length > 0) {
                const topClass = classes.reduce((prev, current) => 
                    (prev.total > current.total) ? prev : current
                );
                stars.queueDay = topClass.name;
                document.getElementById('queueStarDay').textContent = topClass.name;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            const present = teachers.filter(t => t.status === 'present').length;
            const absent = teachers.filter(t => t.status === 'absent').length;
            const notRecorded = teachers.filter(t => t.status === 'not-recorded').length;
            const total = teachers.length;
            
            document.getElementById('presentCount').textContent = present;
            document.getElementById('absentCount').textContent = absent;
            document.getElementById('notRecordedCount').textContent = notRecorded;
            document.getElementById('totalCount').textContent = total;

            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
            const attendanceRate = total > 0 ? Math.round((present / total) * 100) : 0;
            document.getElementById('attendanceRate').textContent = attendanceRate + '%';
            document.getElementById('totalTeachers').textContent = total;
            document.getElementById('totalClasses').textContent = classes.length;
            
            const uptime = Math.floor((Date.now() - startTime) / 60000);
            document.getElementById('systemUptime').textContent = uptime;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(sectionName).classList.add('active');
            event.target.classList.add('active');
        }

        // Ø¹Ø±Ø¶ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        function showAdminTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(`adminTab-${tabName}`).classList.add('active');
        }

        // ÙØ­Øµ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        function checkAdminPassword() {
            const password = document.getElementById('adminPassword').value;
            if (password === settings.adminPassword) {
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                updateStarSelects();
            } else {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù†Ø¬ÙˆÙ…
        function updateStarSelects() {
            const teacherSelects = ['starOfDaySelect', 'starOfWeekSelect', 'starOfMonthSelect'];
            const classSelects = ['queueStarDaySelect', 'queueStarWeekSelect', 'queueStarMonthSelect'];

            teacherSelects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</option>';
                teachers.forEach(teacher => {
                    const option = document.createElement('option');
                    option.value = teacher.name;
                    option.textContent = teacher.name;
                    select.appendChild(option);
                });
            });

            classSelects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>';
                classes.forEach(classItem => {
                    const option = document.createElement('option');
                    option.value = classItem.name;
                    option.textContent = classItem.name;
                    select.appendChild(option);
                });
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¬ÙˆÙ…
        function updateStarOfDay() {
            const value = document.getElementById('starOfDaySelect').value;
            stars.teacherDay = value;
            document.getElementById('starOfDay').textContent = value || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯';
        }

        function updateStarOfWeek() {
            const value = document.getElementById('starOfWeekSelect').value;
            stars.teacherWeek = value;
        }

        function updateStarOfMonth() {
            const value = document.getElementById('starOfMonthSelect').value;
            stars.teacherMonth = value;
            document.getElementById('starOfMonth').textContent = value || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯';
        }

        function updateQueueStarDay() {
            const value = document.getElementById('queueStarDaySelect').value;
            if (value) {
                stars.queueDay = value;
                document.getElementById('queueStarDay').textContent = value;
            }
        }

        function updateQueueStarWeek() {
            const value = document.getElementById('queueStarWeekSelect').value;
            stars.queueWeek = value;
        }

        function updateQueueStarMonth() {
            const value = document.getElementById('queueStarMonthSelect').value;
            stars.queueMonth = value;
            document.getElementById('queueStarMonth').textContent = value || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¹Ø¯';
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø©
        function addTeacher() {
            const name = document.getElementById('newTeacherName').value.trim();
            const className = document.getElementById('newTeacherClass').value.trim();
            
            if (name && className) {
                const newTeacher = {
                    id: teachers.length + 1,
                    name: name,
                    class: className,
                    status: 'not-recorded',
                    attendanceTime: null
                };
                
                teachers.push(newTeacher);
                renderTeachers();
                updateStats();
                updateStarSelects();
                
                document.getElementById('newTeacherName').value = '';
                document.getElementById('newTeacherClass').value = '';
                
                alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!');
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø© ÙˆØ§Ù„ØµÙ');
            }
        }

        // Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„Ù„Ù…Ø¹Ù„Ù…Ø§Øª
        function uploadTeachersExcel() {
            const fileInput = document.getElementById('teachersExcelFile');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // Ù…Ø­Ø§ÙƒØ§Ø© Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù CSV
                        const csvText = e.target.result;
                        const lines = csvText.split('\n');
                        const newTeachers = [];
                        
                        for (let i = 1; i < lines.length; i++) {
                            const columns = lines[i].split(',');
                            if (columns.length >= 2 && columns[0].trim() && columns[1].trim()) {
                                newTeachers.push({
                                    id: teachers.length + newTeachers.length + 1,
                                    name: columns[0].trim(),
                                    class: columns[1].trim(),
                                    status: 'not-recorded',
                                    attendanceTime: null
                                });
                            }
                        }
                        
                        teachers.push(...newTeachers);
                        renderTeachers();
                        updateStats();
                        updateStarSelects();
                        
                        alert(`ØªÙ… Ø±ÙØ¹ ${newTeachers.length} Ù…Ø¹Ù„Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!`);
                    } catch (error) {
                        alert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù.');
                    }
                };
                reader.readAsText(file);
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù');
            }
        }

        // Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„Ù„ØµÙÙˆÙ
        function uploadClassesExcel() {
            const fileInput = document.getElementById('classesExcelFile');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const csvText = e.target.result;
                        const lines = csvText.split('\n');
                        const newClasses = [];
                        
                        for (let i = 1; i < lines.length; i++) {
                            const columns = lines[i].split(',');
                            if (columns.length >= 1 && columns[0].trim()) {
                                newClasses.push({
                                    id: classes.length + newClasses.length + 1,
                                    name: columns[0].trim(),
                                    speed: 0,
                                    quiet: 0,
                                    cleanliness: 0,
                                    soundLevel: 0,
                                    dailyPoints: 0,
                                    monthlyPoints: 0,
                                    total: 0
                                });
                            }
                        }
                        
                        classes.push(...newClasses);
                        renderClasses();
                        updateStarSelects();
                        
                        alert(`ØªÙ… Ø±ÙØ¹ ${newClasses.length} ØµÙ Ø¨Ù†Ø¬Ø§Ø­!`);
                    } catch (error) {
                        alert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù.');
                    }
                };
                reader.readAsText(file);
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù');
            }
        }

        // Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª
        function uploadLogo(logoNumber) {
            const fileInput = document.getElementById(`schoolLogo${logoNumber}`);
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    settings[`logo${logoNumber}`] = e.target.result;
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø´Ø¹Ø§Ø±
                    const preview = document.getElementById(`logo${logoNumber}Preview`);
                    preview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: contain; border-radius: 10px;">`;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø¹Ø§Ø± ÙÙŠ Ø§Ù„ØªØ±ÙˆÙŠØ³Ø©
                    const headerLogo = document.getElementById(`logo${logoNumber}`);
                    headerLogo.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: contain; border-radius: 50%;">`;
                    headerLogo.style.background = 'transparent';
                    
                    alert(`ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø± ${logoNumber} Ø¨Ù†Ø¬Ø§Ø­!`);
                };
                reader.readAsDataURL(file);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        function updateSystemSettings() {
            const schoolName = document.getElementById('schoolName').value.trim();
            const principalName = document.getElementById('principalName').value.trim();
            const subtitle = document.getElementById('systemSubtitle').value.trim();
            const currentPassword = document.getElementById('currentPassword').value.trim();
            const newPassword = document.getElementById('newSystemPassword').value.trim();
            
            if (schoolName) {
                settings.schoolName = schoolName;
                document.getElementById('schoolInfo').textContent = schoolName;
            }
            
            if (principalName) {
                settings.principalName = principalName;
                document.getElementById('principalInfo').textContent = `Ø§Ù„Ù…Ø¯ÙŠØ±Ø©: ${principalName}`;
            }
            
            if (subtitle) {
                settings.subtitle = subtitle;
                document.getElementById('subtitle').textContent = subtitle;
            }
            
            if (newPassword) {
                if (currentPassword === settings.adminPassword) {
                    settings.adminPassword = newPassword;
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newSystemPassword').value = '';
                    alert('ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!');
                } else {
                    alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    return;
                }
            }
            
            alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
        }

        // ÙØªØ­ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function openCertificatePreview(certificateType) {
            currentCertificateType = certificateType;
            generateCertificateCanvas(certificateType);
            document.getElementById('certificateModal').style.display = 'flex';
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¹Ù„Ù‰ Canvas
        function generateCertificateCanvas(type) {
            const canvas = document.getElementById('certificateCanvas');
            const ctx = canvas.getContext('2d');
            
            // Ù…Ø³Ø­ Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Ø®Ù„ÙÙŠØ© Ù…ØªØ¯Ø±Ø¬Ø©
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#ff6b9d');
            gradient.addColorStop(0.5, '#ffa726');
            gradient.addColorStop(1, '#42a5f5');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Ø¥Ø·Ø§Ø± Ø²Ø®Ø±ÙÙŠ
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 8;
            ctx.strokeRect(40, 40, canvas.width - 80, canvas.height - 80);
            
            ctx.strokeStyle = '#ffd700';
            ctx.lineWidth = 4;
            ctx.strokeRect(50, 50, canvas.width - 100, canvas.height - 100);
            
            // Ø§Ù„Ù†ØµÙˆØµ
            ctx.fillStyle = '#fff';
            ctx.textAlign = 'center';
            ctx.font = 'bold 28px Arial';
            ctx.fillText(settings.schoolName, canvas.width / 2, 140);
            
            ctx.font = 'bold 24px Arial';
            ctx.fillText(getCertificateTitle(type), canvas.width / 2, 180);
            
            ctx.font = '20px Arial';
            ctx.fillText('ØªÙÙ…Ù†Ø­ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¥Ù„Ù‰', canvas.width / 2, 240);
            
            ctx.font = 'bold 32px Arial';
            ctx.fillStyle = '#ffd700';
            const recipient = getRecipientName(type);
            ctx.fillText(recipient, canvas.width / 2, 300);
            
            ctx.fillStyle = '#fff';
            ctx.font = '18px Arial';
            const reason = getCertificateReason(type);
            ctx.fillText(reason, canvas.width / 2, 360);
            
            // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
            const now = new Date();
            const gregorianDate = now.toLocaleDateString('ar-SA');
            const hijriDate = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }).format(now);
            
            ctx.font = '16px Arial';
            ctx.fillText(`Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ: ${gregorianDate}`, canvas.width / 2, 420);
            ctx.fillText(`Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ: ${hijriDate}`, canvas.width / 2, 450);
            
            // ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ±Ø©
            ctx.font = 'bold 18px Arial';
            ctx.fillText(`Ø§Ù„Ù…Ø¯ÙŠØ±Ø©: ${settings.principalName}`, canvas.width / 2, 520);
            
            // Ø®ØªÙ… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ø¯Ø§Ø¦Ø±Ø© Ø²Ø®Ø±ÙÙŠØ©)
            ctx.beginPath();
            ctx.arc(canvas.width - 150, canvas.height - 100, 40, 0, 2 * Math.PI);
            ctx.strokeStyle = '#ffd700';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.font = '12px Arial';
            ctx.fillText('Ø®ØªÙ… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', canvas.width - 150, canvas.height - 95);
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function getCertificateTitle(type) {
            const titles = {
                'teacher-day': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…',
                'teacher-week': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                'teacher-month': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±',
                'attendance': 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ',
                'queue-day': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ',
                'queue-week': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ',
                'queue-month': 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ',
                'class-excellence': 'Ø´Ù‡Ø§Ø¯Ø© ØªÙ…ÙŠØ² Ø§Ù„ØµÙ'
            };
            return titles[type] || 'Ø´Ù‡Ø§Ø¯Ø© ØªÙ‚Ø¯ÙŠØ±';
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…
        function getRecipientName(type) {
            const customRecipient = document.getElementById('customRecipient')?.value.trim();
            if (customRecipient) return customRecipient;
            
            const recipients = {
                'teacher-day': stars.teacherDay || 'Ù†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…',
                'teacher-week': stars.teacherWeek || 'Ù†Ø¬Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                'teacher-month': stars.teacherMonth || 'Ù†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±',
                'attendance': 'Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©',
                'queue-day': stars.queueDay || 'Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…',
                'queue-week': stars.queueWeek || 'Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                'queue-month': stars.queueMonth || 'Ù†Ø¬Ù… Ø§Ù„Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø´Ù‡Ø±',
                'class-excellence': 'Ø§Ù„ØµÙ Ø§Ù„Ù…ØªÙ…ÙŠØ²'
            };
            return recipients[type] || 'Ø§Ù„Ù…Ø³ØªÙ„Ù…';
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¨Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function getCertificateReason(type) {
            const customReason = document.getElementById('customReason')?.value.trim();
            if (customReason) return customReason;
            
            const reasons = {
                'teacher-day': 'Ù„ØªÙ…ÙŠØ²Ù‡Ø§ ÙƒÙ†Ø¬Ù…Ø© Ø§Ù„ÙŠÙˆÙ…',
                'teacher-week': 'Ù„ØªÙ…ÙŠØ²Ù‡Ø§ ÙƒÙ†Ø¬Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                'teacher-month': 'Ù„ØªÙ…ÙŠØ²Ù‡Ø§ ÙƒÙ†Ø¬Ù…Ø© Ø§Ù„Ø´Ù‡Ø±',
                'attendance': 'Ù„Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ ÙˆØ§Ù„Ø§Ù†ØªØ¸Ø§Ù… Ø§Ù„Ù…ØªÙ…ÙŠØ²',
                'queue-day': 'Ù„ØªÙ…ÙŠØ² Ø§Ù„ØµÙ ÙÙŠ Ø·Ø§Ø¨ÙˆØ± Ø§Ù„ÙŠÙˆÙ…',
                'queue-week': 'Ù„ØªÙ…ÙŠØ² Ø§Ù„ØµÙ ÙÙŠ Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                'queue-month': 'Ù„ØªÙ…ÙŠØ² Ø§Ù„ØµÙ ÙÙŠ Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ø´Ù‡Ø±',
                'class-excellence': 'Ù„Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø· Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ'
            };
            return reasons[type] || 'Ù„Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹';
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function downloadCertificate() {
            const canvas = document.getElementById('certificateCanvas');
            const link = document.createElement('a');
            link.download = `Ø´Ù‡Ø§Ø¯Ø©_${getCertificateTitle(currentCertificateType)}_${new Date().toLocaleDateString('ar-SA')}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function printCertificate() {
            const canvas = document.getElementById('certificateCanvas');
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head><title>Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</title></head>
                <body style="margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh;">
                    <img src="${canvas.toDataURL()}" style="max-width: 100%; height: auto;">
                </body>
                </html>
            `);
            printWindow.document.close();
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 1000);
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
        function closeCertificateModal() {
            document.getElementById('certificateModal').style.display = 'none';
        }

        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø´Ù‡Ø§Ø¯Ø© Ù…Ø®ØµØµØ©
        function previewCustomCertificate() {
            openCertificatePreview('custom');
        }

        // Ø·Ø¨Ø§Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
        function printAllCertificates() {
            const types = ['teacher-day', 'teacher-week', 'teacher-month', 'attendance', 'queue-day', 'queue-week', 'queue-month', 'class-excellence'];
            
            types.forEach((type, index) => {
                setTimeout(() => {
                    openCertificatePreview(type);
                    setTimeout(() => {
                        downloadCertificate();
                        closeCertificateModal();
                    }, 1000);
                }, index * 2000);
            });
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
        function exportReport(format) {
            const period = document.getElementById('reportPeriod').value;
            const type = document.getElementById('reportType').value;
            
            alert(`Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± ${type} ${period} Ø¨ØµÙŠØºØ© ${format}`);
        }

        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets
        async function importFromGoogleSheets() {
            const url = document.getElementById('googleSheetsUrl').value.trim() || googleSheetsUrl;
            const statusDiv = document.getElementById('importStatus');
            const previewDiv = document.getElementById('importedDataPreview');
            const listDiv = document.getElementById('importedDataList');
            
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets...';
            statusDiv.style.color = '#ffa726';
            
            console.log('Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ:', url);
            
            try {
                // ØªØ­ÙˆÙŠÙ„ Ø±Ø§Ø¨Ø· pubhtml Ø¥Ù„Ù‰ CSV
                let csvUrl = url;
                let spreadsheetId = '';
                let gid = '836784017'; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¹Ø·Ù‰
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ùˆ gid Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
                if (url.includes('/spreadsheets/d/')) {
                    const idMatch = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
                    if (idMatch) {
                        spreadsheetId = idMatch[1];
                    }
                }
                
                if (url.includes('gid=')) {
                    const gidMatch = url.match(/gid=(\d+)/);
                    if (gidMatch) {
                        gid = gidMatch[1];
                    }
                }
                
                console.log('Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„:', spreadsheetId);
                console.log('Ù…Ø¹Ø±Ù Ø§Ù„ÙˆØ±Ù‚Ø© (gid):', gid);
                
                if (spreadsheetId) {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· CSV Ù…Ø¨Ø§Ø´Ø±
                    csvUrl = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?format=csv&gid=${gid}`;
                } else if (url.includes('/pubhtml')) {
                    // Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„Ø±ÙˆØ§Ø¨Ø· pubhtml
                    csvUrl = url.split('/pubhtml')[0] + `/export?format=csv&gid=${gid}`;
                } else if (url.includes('/edit')) {
                    csvUrl = url.replace('/edit#gid=0', '/export?format=csv').replace('/edit', '/export?format=csv');
                }
                
                console.log('Ø±Ø§Ø¨Ø· CSV Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:', csvUrl);
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… CORS proxy Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl);
                console.log('Ø±Ø§Ø¨Ø· Proxy:', proxyUrl);
                
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
                const csvText = await response.text();
                const newTeachers = parseCSVData(csvText);
                
                if (newTeachers.length > 0) {
                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø© Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©
                    lastImportedData = {
                        teachers: JSON.parse(JSON.stringify(newTeachers)),
                        timestamp: new Date().toISOString(),
                        url: url
                    };
                    
                    // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
                    displayImportedDataPreview(newTeachers);
                    
                    // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                    const preserveAttendance = teachers.length > 0 && confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ');
                    
                    if (preserveAttendance) {
                        // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø­Ø¶ÙˆØ±
                        mergeTeachersData(newTeachers);
                    } else {
                        teachers = newTeachers;
                    }
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
                    const uniqueClasses = [...new Set(teachers.map(t => t.class))];
                    const existingClassNames = classes.map(c => c.name);
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø·
                    uniqueClasses.forEach(className => {
                        if (!existingClassNames.includes(className)) {
                            classes.push({
                                id: classes.length + 1,
                                name: className,
                                speed: 0,
                                quiet: 0,
                                cleanliness: 0,
                                total: 0
                            });
                        }
                    });
                    
                    renderTeachers();
                    renderClasses();
                    updateStats();
                    updateStarSelects();
                    
                    statusDiv.innerHTML = `âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${newTeachers.length} Ù…Ø¹Ù„Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚.`;
                    statusDiv.style.color = '#4caf50';
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
                    startAutoUpdate();
                    
                    setTimeout(() => {
                        statusDiv.style.display = 'none';
                    }, 5000);
                    
                } else {
                    throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„');
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                statusDiv.innerHTML = 'âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù†Ø´ÙˆØ± Ù„Ù„Ø¹Ø§Ù…Ø©.';
                statusDiv.style.color = '#f44336';
                
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 8000);
            }
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª CSV
        function parseCSVData(csvText) {
            console.log('ğŸ“„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… Ù…Ù† Ø§Ù„Ø´ÙŠØª (Ø£ÙˆÙ„ 500 Ø­Ø±Ù):', csvText.substring(0, 500));
            
            const lines = csvText.split('\n').filter(line => line.trim());
            const newTeachers = [];
            
            console.log('ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:', lines.length);
            
            if (lines.length === 0) {
                console.log('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø·Ø± ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                return newTeachers;
            }
            
            console.log('ğŸ“‹ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†):', lines[0]);
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¹Ù…Ø¯Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø© ÙˆØ§Ù„ØµÙ
            const headerLine = lines[0];
            const headerColumns = parseCSVLine(headerLine);
            
            console.log('ğŸ“ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†:', headerColumns);
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙÙ‡Ø§Ø±Ø³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            let nameColumnIndex = -1;
            let classColumnIndex = -1;
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
            headerColumns.forEach((header, index) => {
                const cleanHeader = header.trim().toLowerCase().replace(/"/g, '');
                console.log(`ğŸ” ÙØ­Øµ Ø§Ù„Ø¹Ù…ÙˆØ¯ ${index}: "${cleanHeader}"`);
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙˆØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
                if (nameColumnIndex === -1 && (
                    cleanHeader.includes('Ø§Ø³Ù…') || 
                    cleanHeader.includes('Ù…Ø¹Ù„Ù…') || 
                    cleanHeader.includes('name') ||
                    cleanHeader.includes('teacher') ||
                    cleanHeader === 'Ø§Ù„Ø§Ø³Ù…' ||
                    cleanHeader === 'Ø§Ù„Ù…Ø¹Ù„Ù…Ø©'
                )) {
                    nameColumnIndex = index;
                    console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„ÙÙ‡Ø±Ø³: ${index}`);
                }
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙ
                if (classColumnIndex === -1 && (
                    cleanHeader.includes('ØµÙ') || 
                    cleanHeader.includes('class') ||
                    cleanHeader.includes('grade') ||
                    cleanHeader === 'Ø§Ù„ØµÙ' ||
                    cleanHeader === 'Ø§Ù„ÙØµÙ„'
                )) {
                    classColumnIndex = index;
                    console.log(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙ ÙÙŠ Ø§Ù„ÙÙ‡Ø±Ø³: ${index}`);
                }
            });
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ù†ÙØªØ±Ø¶ Ø£Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ Ù‡Ùˆ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ Ù‡Ùˆ Ø§Ù„ØµÙ
            if (nameColumnIndex === -1 && classColumnIndex === -1) {
                console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…Ø­Ø¯Ø¯Ø©ØŒ Ø³ÙŠØªÙ… Ø§ÙØªØ±Ø§Ø¶ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ = Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø«Ø§Ù†ÙŠ = Ø§Ù„ØµÙ');
                nameColumnIndex = 0;
                classColumnIndex = 1;
            } else if (nameColumnIndex === -1) {
                nameColumnIndex = 0;
                console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù…ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„');
            } else if (classColumnIndex === -1) {
                classColumnIndex = 1;
                console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ');
            }
            
            console.log(`ğŸ“ ÙÙ‡Ø±Ø³ Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù…: ${nameColumnIndex}`);
            console.log(`ğŸ“ ÙÙ‡Ø±Ø³ Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙ: ${classColumnIndex}`);
            
            // ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª (ØªØ®Ø·ÙŠ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„)
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) {
                    console.log(`â­ï¸ ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø·Ø± ${i} - ÙØ§Ø±Øº`);
                    continue;
                }
                
                console.log(`ğŸ“ Ø§Ù„Ø³Ø·Ø± ${i}: "${line}"`);
                
                const columns = parseCSVLine(line);
                console.log(`ğŸ“Š Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ø³Ø·Ø± ${i}:`, columns);
                
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                if (columns.length > Math.max(nameColumnIndex, classColumnIndex)) {
                    const teacherName = columns[nameColumnIndex] ? columns[nameColumnIndex].trim().replace(/"/g, '') : '';
                    const className = columns[classColumnIndex] ? columns[classColumnIndex].trim().replace(/"/g, '') : '';
                    
                    console.log(`ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©: "${teacherName}"`);
                    console.log(`ğŸ« Ø§Ù„ØµÙ: "${className}"`);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    if (teacherName && className && 
                        teacherName !== '' && className !== '' &&
                        teacherName.length > 1 && className.length > 1 &&
                        !teacherName.toLowerCase().includes('name') &&
                        !className.toLowerCase().includes('class')) {
                        
                        console.log(`âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…Ø©: ${teacherName} - ${className}`);
                        newTeachers.push({
                            id: newTeachers.length + 1,
                            name: teacherName,
                            class: className,
                            status: 'not-recorded',
                            attendanceTime: null
                        });
                    } else {
                        console.log(`â­ï¸ ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø·Ø± ${i} - Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©:`, { 
                            teacherName: teacherName || 'ÙØ§Ø±Øº', 
                            className: className || 'ÙØ§Ø±Øº',
                            nameLength: teacherName.length,
                            classLength: className.length
                        });
                    }
                } else {
                    console.log(`â­ï¸ ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø·Ø± ${i} - Ø£Ø¹Ù…Ø¯Ø© ØºÙŠØ± ÙƒØ§ÙÙŠØ©: ${columns.length} (Ù…Ø·Ù„ÙˆØ¨: ${Math.max(nameColumnIndex, classColumnIndex) + 1})`);
                }
            }
            
            console.log('ğŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©:', newTeachers.length);
            console.log('ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª:', newTeachers.map(t => `${t.name} - ${t.class}`));
            
            return newTeachers;
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ø³Ø·Ø± CSV Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        function loadDefaultData() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
                loadSampleData();
                alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
            }
        }

        // Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
        function backupData() {
            const backupData = {
                teachers: teachers,
                classes: classes,
                stars: stars,
                settings: settings,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Ù†Ø³Ø®Ø©_Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©_${new Date().toLocaleDateString('ar-SA')}.json`;
            link.click();
        }

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function restoreData() {
            const fileInput = document.getElementById('restoreFile');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        
                        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
                            teachers = backupData.teachers || [];
                            classes = backupData.classes || [];
                            stars = backupData.stars || {};
                            settings = { ...settings, ...backupData.settings };
                            
                            renderTeachers();
                            renderClasses();
                            updateStats();
                            updateStarSelects();
                            
                            alert('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
                        }
                    } catch (error) {
                        alert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
        function clearAttendanceData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±ØŸ')) {
                teachers.forEach(teacher => {
                    teacher.status = 'not-recorded';
                    teacher.attendanceTime = null;
                });
                renderTeachers();
                updateStats();
                alert('ØªÙ… Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!');
            }
        }

        // Ù…Ø³Ø­ Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙÙˆÙ
        function clearPointsData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙÙˆÙØŸ')) {
                classes.forEach(classItem => {
                    classItem.speed = 0;
                    classItem.quiet = 0;
                    classItem.cleanliness = 0;
                    classItem.soundLevel = 0;
                    classItem.dailyPoints = 0;
                    classItem.monthlyPoints = 0;
                    classItem.total = 0;
                });
                renderClasses();
                alert('ØªÙ… Ù…Ø³Ø­ Ù†Ù‚Ø§Ø· Ø§Ù„ØµÙÙˆÙ Ø¨Ù†Ø¬Ø§Ø­!');
            }
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…
        function resetSystem() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                if (confirm('ØªØ£ÙƒÙŠØ¯ Ø£Ø®ÙŠØ±: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹!')) {
                    teachers = [];
                    classes = [];
                    stars = {
                        teacherDay: null,
                        teacherWeek: null,
                        teacherMonth: null,
                        queueDay: null,
                        queueWeek: null,
                        queueMonth: null
                    };
                    
                    renderTeachers();
                    renderClasses();
                    updateStats();
                    updateStarSelects();
                    
                    alert('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!');
                }
            }
        }

        // Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©
        function markAllPresent() {
            teachers.forEach(teacher => {
                if (teacher.status === 'not-recorded') {
                    teacher.status = 'present';
                    teacher.attendanceTime = new Date().toLocaleTimeString('ar-SA');
                }
            });
            renderTeachers();
            updateStats();
            alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª ÙƒØ­Ø§Ø¶Ø±Ø§Øª!');
        }

        function resetAllAttendance() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø¶ÙˆØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§ØªØŸ')) {
                teachers.forEach(teacher => {
                    teacher.status = 'not-recorded';
                    teacher.attendanceTime = null;
                });
                renderTeachers();
                updateStats();
                alert('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!');
            }
        }

        function copyTeachersData() {
            let dataText = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©\tØ§Ù„ØµÙ\tØ§Ù„Ø­Ø§Ù„Ø©\tÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„\n';
            
            teachers.forEach(teacher => {
                const statusText = {
                    'present': 'Ø­Ø§Ø¶Ø±Ø©',
                    'absent': 'ØºØ§Ø¦Ø¨Ø©',
                    'late': 'Ù…ØªØ£Ø®Ø±Ø©',
                    'excused': 'Ø¨Ø¹Ø°Ø±',
                    'not-recorded': 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„'
                };
                
                dataText += `${teacher.name}\t${teacher.class}\t${statusText[teacher.status]}\t${teacher.attendanceTime || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„'}\n`;
            });
            
            navigator.clipboard.writeText(dataText).then(() => {
                alert('ØªÙ… Ù†Ø³Ø® Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
            }).catch(() => {
                alert('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            });
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        async function initializeSystem() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ø´ÙŠØª Ø£ÙˆÙ„Ø§Ù‹
            console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… - Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...');
            
            try {
                await autoImportFromSheet();
            } catch (error) {
                console.log('âš ï¸ ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...');
                loadSampleData();
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setInterval(updateStats, 60000);
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
            setInterval(async () => {
                console.log('ğŸ”„ ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª...');
                await autoImportFromSheet(true);
            }, 30 * 1000); // ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
        }

        // Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ø´ÙŠØª
        async function autoImportFromSheet(silent = false) {
            const defaultUrl = googleSheetsUrl;
            
            if (!silent) {
                console.log('ğŸ“¥ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ø´ÙŠØª...');
                showAutoImportStatus('â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø´ÙŠØª...', '#ffa726');
            }
            
            try {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
                let spreadsheetId = '';
                let gid = '0'; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                
                // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø±ÙˆØ§Ø¨Ø· Google Sheets
                if (defaultUrl.includes('/spreadsheets/d/e/')) {
                    // Ø±Ø§Ø¨Ø· Ù…Ù†Ø´ÙˆØ±
                    const idMatch = defaultUrl.match(/\/spreadsheets\/d\/e\/([a-zA-Z0-9-_]+)/);
                    if (idMatch) {
                        spreadsheetId = idMatch[1];
                    }
                } else if (defaultUrl.includes('/spreadsheets/d/')) {
                    // Ø±Ø§Ø¨Ø· Ø¹Ø§Ø¯ÙŠ
                    const idMatch = defaultUrl.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
                    if (idMatch) {
                        spreadsheetId = idMatch[1];
                    }
                }
                
                if (!spreadsheetId) {
                    throw new Error('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·');
                }
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ gid Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
                const gidMatch = defaultUrl.match(/gid=(\d+)/);
                if (gidMatch) {
                    gid = gidMatch[1];
                }
                
                console.log('ğŸ“‹ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„:', spreadsheetId);
                console.log('ğŸ“„ Ù…Ø¹Ø±Ù Ø§Ù„ÙˆØ±Ù‚Ø©:', gid);
                
                // ØªØ¬Ø±Ø¨Ø© Ø¹Ø¯Ø© Ø·Ø±Ù‚ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                let csvText = '';
                let success = false;
                
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø±Ø§Ø¨Ø· CSV Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©
                if (!success) {
                    try {
                        const csvUrl1 = `https://docs.google.com/spreadsheets/d/e/${spreadsheetId}/pub?output=csv&gid=${gid}`;
                        console.log('ğŸ”— Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1:', csvUrl1);
                        
                        const proxyUrl1 = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl1);
                        const response1 = await fetch(proxyUrl1);
                        
                        if (response1.ok) {
                            csvText = await response1.text();
                            if (csvText && csvText.length > 50 && !csvText.includes('<!DOCTYPE html>')) {
                                success = true;
                                console.log('âœ… Ù†Ø¬Ø­Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1');
                            }
                        }
                    } catch (e) {
                        console.log('âŒ ÙØ´Ù„Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1:', e.message);
                    }
                }
                
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø±Ø§Ø¨Ø· export Ù…Ø¨Ø§Ø´Ø±
                if (!success) {
                    try {
                        const csvUrl2 = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?format=csv&gid=${gid}`;
                        console.log('ğŸ”— Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2:', csvUrl2);
                        
                        const proxyUrl2 = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl2);
                        const response2 = await fetch(proxyUrl2);
                        
                        if (response2.ok) {
                            csvText = await response2.text();
                            if (csvText && csvText.length > 50 && !csvText.includes('<!DOCTYPE html>')) {
                                success = true;
                                console.log('âœ… Ù†Ø¬Ø­Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2');
                            }
                        }
                    } catch (e) {
                        console.log('âŒ ÙØ´Ù„Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2:', e.message);
                    }
                }
                
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¯ÙˆÙ† gid
                if (!success) {
                    try {
                        const csvUrl3 = `https://docs.google.com/spreadsheets/d/e/${spreadsheetId}/pub?output=csv`;
                        console.log('ğŸ”— Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 3:', csvUrl3);
                        
                        const proxyUrl3 = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl3);
                        const response3 = await fetch(proxyUrl3);
                        
                        if (response3.ok) {
                            csvText = await response3.text();
                            if (csvText && csvText.length > 50 && !csvText.includes('<!DOCTYPE html>')) {
                                success = true;
                                console.log('âœ… Ù†Ø¬Ø­Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 3');
                            }
                        }
                    } catch (e) {
                        console.log('âŒ ÙØ´Ù„Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 3:', e.message);
                    }
                }
                
                if (!success || !csvText) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªØ§Ø­Ø©');
                }
                
                console.log('ğŸ“„ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø§Ù„Ø­Ø¬Ù…:', csvText.length, 'Ø­Ø±Ù');
                console.log('ğŸ“„ Ø£ÙˆÙ„ 200 Ø­Ø±Ù:', csvText.substring(0, 200));
                
                const newTeachers = parseCSVData(csvText);
                console.log('ğŸ‘¥ ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬', newTeachers.length, 'Ù…Ø¹Ù„Ù…Ø©');
                
                if (newTeachers.length === 0) {
                    console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø©');
                    console.log('ğŸ“„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©:', csvText);
                    throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„');
                }
                
                // ÙØ­Øµ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
                let hasChanges = true;
                if (teachers.length > 0) {
                    const changeResult = detectChanges(teachers, newTeachers);
                    hasChanges = changeResult.changed;
                    
                    if (hasChanges && !silent) {
                        console.log('ğŸ”„ ØªÙ… Ø§ÙƒØªØ´Ø§Ù ØªØºÙŠÙŠØ±Ø§Øª:', changeResult.summary);
                    }
                }
                
                if (hasChanges || teachers.length === 0) {
                    // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«
                    if (teachers.length > 0) {
                        mergeTeachersData(newTeachers);
                    } else {
                        teachers = newTeachers;
                    }
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    updateClassesFromTeachers();
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                    renderTeachers();
                    renderClasses();
                    updateStats();
                    updateStarSelects();
                    
                    if (!silent) {
                        showAutoImportStatus(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${newTeachers.length} Ù…Ø¹Ù„Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹! Ø³ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©.`, '#4caf50');
                        console.log('âœ… ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ù†Ø¬Ø§Ø­');
                    } else {
                        showAutoImportStatus(`ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (${newTeachers.length} Ù…Ø¹Ù„Ù…Ø©)`, '#2196f3', 2000);
                        console.log('ğŸ”„ ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
                    }
                } else if (!silent) {
                    showAutoImportStatus('âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø¯Ø«Ø©ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.', '#4caf50', 3000);
                    console.log('âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:', error);
                
                if (!silent) {
                    showAutoImportStatus('âš ï¸ ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©.', '#ff9800', 5000);
                    
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„
                    if (teachers.length === 0) {
                        loadSampleData();
                    }
                }
                
                throw error;
            }
        }

        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function showAutoImportStatus(message, color, duration = 5000) {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            let statusBar = document.getElementById('autoImportStatus');
            if (!statusBar) {
                statusBar = document.createElement('div');
                statusBar.id = 'autoImportStatus';
                statusBar.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    z-index: 9999;
                    padding: 1rem;
                    text-align: center;
                    font-family: 'Tajawal', sans-serif;
                    font-weight: 600;
                    font-size: 1rem;
                    backdrop-filter: blur(10px);
                    border-bottom: 1px solid rgba(255,255,255,0.2);
                    transform: translateY(-100%);
                    transition: all 0.3s ease;
                `;
                document.body.appendChild(statusBar);
            }
            
            statusBar.style.background = `linear-gradient(135deg, ${color}, ${color}aa)`;
            statusBar.style.color = 'white';
            statusBar.textContent = message;
            statusBar.style.transform = 'translateY(0)';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            setTimeout(() => {
                statusBar.style.transform = 'translateY(-100%)';
            }, duration);
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙˆÙ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
        function updateClassesFromTeachers() {
            const uniqueClasses = [...new Set(teachers.map(t => t.class))];
            const existingClassNames = classes.map(c => c.name);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            uniqueClasses.forEach(className => {
                if (!existingClassNames.includes(className)) {
                    classes.push({
                        id: classes.length + 1,
                        name: className,
                        speed: 0,
                        quiet: 0,
                        cleanliness: 0,
                        soundLevel: 0,
                        dailyPoints: 0,
                        monthlyPoints: 0,
                        total: 0
                    });
                    console.log('â• ØªÙ… Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯:', className);
                }
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ Ù„Ù… ØªØ¹Ø¯ Ù…ÙˆØ¬ÙˆØ¯Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
            classes = classes.filter(classItem => 
                uniqueClasses.includes(classItem.name)
            );
            
            console.log('ğŸ“š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙÙˆÙ:', classes.length);
        }

        // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function displayImportedDataPreview(newTeachers) {
            const previewDiv = document.getElementById('importedDataPreview');
            const listDiv = document.getElementById('importedDataList');
            
            let previewHTML = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.9rem;">';
            
            newTeachers.slice(0, 10).forEach((teacher, index) => {
                previewHTML += `
                    <div style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 5px;">
                        ${index + 1}. ${teacher.name}
                    </div>
                    <div style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 5px;">
                        ${teacher.class}
                    </div>
                `;
            });
            
            if (newTeachers.length > 10) {
                previewHTML += `<div style="grid-column: 1 / -1; text-align: center; padding: 0.5rem; font-style: italic;">... Ùˆ ${newTeachers.length - 10} Ù…Ø¹Ù„Ù…Ø© Ø£Ø®Ø±Ù‰</div>`;
            }
            
            previewHTML += '</div>';
            
            listDiv.innerHTML = previewHTML;
            previewDiv.style.display = 'block';
        }
        
        // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø­Ø¶ÙˆØ±
        function mergeTeachersData(newTeachers) {
            const existingTeachers = new Map();
            teachers.forEach(teacher => {
                existingTeachers.set(teacher.name, teacher);
            });
            
            teachers = newTeachers.map(newTeacher => {
                const existing = existingTeachers.get(newTeacher.name);
                if (existing) {
                    return {
                        ...newTeacher,
                        status: existing.status,
                        attendanceTime: existing.attendanceTime
                    };
                }
                return newTeacher;
            });
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startAutoUpdate() {
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ù† ÙˆØ¬Ø¯
            if (autoUpdateInterval) {
                clearInterval(autoUpdateInterval);
            }
            
            // Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
            autoUpdateInterval = setInterval(async () => {
                await checkForUpdates(true); // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµØ§Ù…Øª
            }, 5 * 60 * 1000); // 5 Ø¯Ù‚Ø§Ø¦Ù‚
        }
        
        // ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
        async function checkForUpdates(silent = false) {
            if (!lastImportedData) {
                if (!silent) {
                    alert('Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù‚Ø¨Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.');
                }
                return;
            }
            
            const statusDiv = document.getElementById('importStatus');
            
            if (!silent) {
                statusDiv.style.display = 'block';
                statusDiv.innerHTML = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª...';
                statusDiv.style.color = '#2196f3';
            }
            
            try {
                const url = lastImportedData.url;
                let csvUrl = url;
                if (url.includes('/pubhtml')) {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ gid Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù† ÙˆØ¬Ø¯
                    const gidMatch = url.match(/gid=(\d+)/);
                    const gid = gidMatch ? gidMatch[1] : '0';
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· CSV Ù…Ø¹ gid Ø§Ù„Ù…Ø­Ø¯Ø¯
                    csvUrl = url.split('/pubhtml')[0] + `/export?format=csv&gid=${gid}`;
                } else if (url.includes('/edit')) {
                    csvUrl = url.replace('/edit#gid=0', '/export?format=csv').replace('/edit', '/export?format=csv');
                }
                
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl);
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª');
                }
                
                const csvText = await response.text();
                const newTeachers = parseCSVData(csvText);
                
                // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                const hasChanges = detectChanges(lastImportedData.teachers, newTeachers);
                
                if (hasChanges.changed) {
                    if (silent) {
                        // Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                        statusDiv.style.display = 'block';
                        statusDiv.innerHTML = `ğŸ”„ ØªÙ… Ø§ÙƒØªØ´Ø§Ù ØªØ­Ø¯ÙŠØ«Ø§Øª! ${hasChanges.summary}`;
                        statusDiv.style.color = '#ff9800';
                        
                        setTimeout(() => {
                            statusDiv.style.display = 'none';
                        }, 5000);
                    }
                    
                    if (!silent || confirm(`ØªÙ… Ø§ÙƒØªØ´Ø§Ù ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:\n${hasChanges.summary}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§ØªØŸ`)) {
                        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø­Ø¶ÙˆØ±
                        mergeTeachersData(newTeachers);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙˆÙ
                        const uniqueClasses = [...new Set(teachers.map(t => t.class))];
                        const existingClassNames = classes.map(c => c.name);
                        
                        uniqueClasses.forEach(className => {
                            if (!existingClassNames.includes(className)) {
                                classes.push({
                                    id: classes.length + 1,
                                    name: className,
                                    speed: 0,
                                    quiet: 0,
                                    cleanliness: 0,
                                    total: 0
                                });
                            }
                        });
                        
                        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
                        lastImportedData = {
                            teachers: JSON.parse(JSON.stringify(newTeachers)),
                            timestamp: new Date().toISOString(),
                            url: url
                        };
                        
                        renderTeachers();
                        renderClasses();
                        updateStats();
                        updateStarSelects();
                        displayImportedDataPreview(teachers);
                        
                        if (!silent) {
                            statusDiv.innerHTML = `âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! ${hasChanges.summary}`;
                            statusDiv.style.color = '#4caf50';
                            
                            setTimeout(() => {
                                statusDiv.style.display = 'none';
                            }, 5000);
                        }
                    }
                } else {
                    if (!silent) {
                        statusDiv.innerHTML = 'âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø¯Ø«Ø©ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.';
                        statusDiv.style.color = '#4caf50';
                        
                        setTimeout(() => {
                            statusDiv.style.display = 'none';
                        }, 3000);
                    }
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª:', error);
                if (!silent) {
                    statusDiv.innerHTML = 'âŒ ÙØ´Ù„ ÙÙŠ ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª.';
                    statusDiv.style.color = '#f44336';
                    
                    setTimeout(() => {
                        statusDiv.style.display = 'none';
                    }, 5000);
                }
            }
        }
        
        // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function detectChanges(oldTeachers, newTeachers) {
            const oldNames = new Set(oldTeachers.map(t => t.name));
            const newNames = new Set(newTeachers.map(t => t.name));
            
            const added = newTeachers.filter(t => !oldNames.has(t.name));
            const removed = oldTeachers.filter(t => !newNames.has(t.name));
            
            // ÙØ­Øµ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„ØµÙÙˆÙ
            const classChanges = [];
            newTeachers.forEach(newTeacher => {
                const oldTeacher = oldTeachers.find(t => t.name === newTeacher.name);
                if (oldTeacher && oldTeacher.class !== newTeacher.class) {
                    classChanges.push({
                        name: newTeacher.name,
                        oldClass: oldTeacher.class,
                        newClass: newTeacher.class
                    });
                }
            });
            
            const hasChanges = added.length > 0 || removed.length > 0 || classChanges.length > 0;
            
            let summary = '';
            if (added.length > 0) summary += `${added.length} Ù…Ø¹Ù„Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŒ `;
            if (removed.length > 0) summary += `${removed.length} Ù…Ø¹Ù„Ù…Ø© Ù…Ø­Ø°ÙˆÙØ©ØŒ `;
            if (classChanges.length > 0) summary += `${classChanges.length} ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„ØµÙÙˆÙ`;
            
            summary = summary.replace(/ØŒ $/, ''); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©
            
            return {
                changed: hasChanges,
                added: added,
                removed: removed,
                classChanges: classChanges,
                summary: summary || 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª'
            };
        }

        // ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª
        async function debugSheetData() {
            const url = googleSheetsUrl;
            
            console.log('ğŸ” Ø¨Ø¯Ø¡ ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·:', url);
            showAutoImportStatus('ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', '#e91e63');
            
            try {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
                let spreadsheetId = '';
                let gid = '0';
                
                if (url.includes('/spreadsheets/d/e/')) {
                    const idMatch = url.match(/\/spreadsheets\/d\/e\/([a-zA-Z0-9-_]+)/);
                    if (idMatch) {
                        spreadsheetId = idMatch[1];
                    }
                } else if (url.includes('/spreadsheets/d/')) {
                    const idMatch = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
                    if (idMatch) {
                        spreadsheetId = idMatch[1];
                    }
                }
                
                const gidMatch = url.match(/gid=(\d+)/);
                if (gidMatch) {
                    gid = gidMatch[1];
                }
                
                if (!spreadsheetId) {
                    throw new Error('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·');
                }
                
                // ØªØ¬Ø±Ø¨Ø© Ø¹Ø¯Ø© Ø·Ø±Ù‚ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                let csvText = '';
                let successfulUrl = '';
                let success = false;
                
                const urlsToTry = [
                    `https://docs.google.com/spreadsheets/d/e/${spreadsheetId}/pub?output=csv&gid=${gid}`,
                    `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?format=csv&gid=${gid}`,
                    `https://docs.google.com/spreadsheets/d/e/${spreadsheetId}/pub?output=csv`
                ];
                
                for (const csvUrl of urlsToTry) {
                    try {
                        console.log('ğŸ”— ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø±Ø§Ø¨Ø·:', csvUrl);
                        const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl);
                        const response = await fetch(proxyUrl);
                        
                        if (response.ok) {
                            const testText = await response.text();
                            if (testText && testText.length > 50 && !testText.includes('<!DOCTYPE html>')) {
                                csvText = testText;
                                successfulUrl = csvUrl;
                                success = true;
                                console.log('âœ… Ù†Ø¬Ø­ Ø§Ù„Ø±Ø§Ø¨Ø·:', csvUrl);
                                break;
                            }
                        }
                    } catch (e) {
                        console.log('âŒ ÙØ´Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·:', csvUrl, e.message);
                    }
                }
                
                if (!success) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¬Ø±Ø¨Ø©');
                }
                
                const newTeachers = parseCSVData(csvText);
                
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„ØªÙØµÙŠÙ„
                const lines = csvText.split('\n').filter(line => line.trim());
                const headerLine = lines[0] || '';
                const headerColumns = parseCSVLine(headerLine);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… Ù„Ù„ØªØ´Ø®ÙŠØµ
                const debugInfo = `
                    <div style="text-align: right; font-family: monospace; font-size: 0.8rem; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 10px; margin-top: 1rem; max-height: 400px; overflow-y: auto;">
                        <h5 style="color: #ffa726; margin-bottom: 1rem;">ğŸ“Š ØªØ´Ø®ÙŠØµ Ù…ÙØµÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</h5>
                        
                        <div style="background: rgba(76,175,80,0.2); padding: 0.5rem; border-radius: 5px; margin-bottom: 1rem;">
                            <strong>âœ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:</strong><br>
                            Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ: ${url}<br>
                            Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Ø§Ø¬Ø­: ${successfulUrl}<br>
                            Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„: ${spreadsheetId}<br>
                            Ù…Ø¹Ø±Ù Ø§Ù„ÙˆØ±Ù‚Ø©: ${gid}
                        </div>
                        
                        <div style="background: rgba(33,150,243,0.2); padding: 0.5rem; border-radius: 5px; margin-bottom: 1rem;">
                            <strong>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong><br>
                            Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${csvText.length} Ø­Ø±Ù<br>
                            Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±: ${lines.length}<br>
                            Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©: ${headerColumns.length}<br>
                            Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©: ${newTeachers.length}
                        </div>
                        
                        <div style="background: rgba(255,193,7,0.2); padding: 0.5rem; border-radius: 5px; margin-bottom: 1rem;">
                            <strong>ğŸ“‹ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†:</strong><br>
                            ${headerColumns.map((col, i) => `${i}: "${col.trim()}"`).join('<br>')}
                        </div>
                        
                        <hr style="border-color: rgba(255,255,255,0.3); margin: 1rem 0;">
                        <h6 style="color: #4caf50;">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… (Ø£ÙˆÙ„ 800 Ø­Ø±Ù):</h6>
                        <pre style="white-space: pre-wrap; word-break: break-all; color: #fff; background: rgba(0,0,0,0.5); padding: 0.5rem; border-radius: 5px; font-size: 0.7rem;">${csvText.substring(0, 800)}${csvText.length > 800 ? '...' : ''}</pre>
                        
                        <hr style="border-color: rgba(255,255,255,0.3); margin: 1rem 0;">
                        <h6 style="color: #2196f3;">Ø£ÙˆÙ„ 5 Ø£Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</h6>
                        <div style="background: rgba(0,0,0,0.5); padding: 0.5rem; border-radius: 5px; font-size: 0.7rem;">
                            ${lines.slice(0, 5).map((line, i) => `Ø§Ù„Ø³Ø·Ø± ${i}: ${line}`).join('<br>')}
                        </div>
                        
                        <hr style="border-color: rgba(255,255,255,0.3); margin: 1rem 0;">
                        <h6 style="color: #e91e63;">Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©:</h6>
                        <div style="max-height: 200px; overflow-y: auto;">
                            ${newTeachers.length > 0 ? 
                                newTeachers.map((t, i) => `<div style="padding: 0.25rem; background: rgba(76,175,80,0.2); margin: 0.25rem 0; border-radius: 3px;">${i+1}. ${t.name} - ${t.class}</div>`).join('') :
                                '<div style="color: #f44336; padding: 1rem; text-align: center;">âŒ Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£ÙŠ Ù…Ø¹Ù„Ù…Ø§Øª</div>'
                            }
                        </div>
                        
                        ${newTeachers.length === 0 ? `
                            <hr style="border-color: rgba(255,255,255,0.3); margin: 1rem 0;">
                            <div style="background: rgba(244,67,54,0.2); padding: 0.5rem; border-radius: 5px;">
                                <strong>ğŸš¨ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:</strong><br>
                                â€¢ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù…ÙˆØ¯ "Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…Ø©" ÙˆØ¹Ù…ÙˆØ¯ "Ø§Ù„ØµÙ"<br>
                                â€¢ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù†Ø´ÙˆØ± Ù„Ù„Ø¹Ø§Ù…Ø©<br>
                                â€¢ ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙÙˆÙ (Ù„ÙŠØ³ ÙÙ‚Ø· Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†)<br>
                                â€¢ Ø¬Ø±Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ù†Ø´Ø± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Google Sheets
                            </div>
                        ` : ''}
                    </div>
                `;
                
                showAutoImportStatus('ğŸ” ØªÙ… ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!' + debugInfo, '#4caf50', 20000);
                
                // ÙØªØ­ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…Ø·ÙˆØ± Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„
                console.log('=== ØªØ´Ø®ÙŠØµ Ù…ÙØµÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===');
                console.log('Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ:', url);
                console.log('Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Ø§Ø¬Ø­:', successfulUrl);
                console.log('Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„:', spreadsheetId);
                console.log('Ù…Ø¹Ø±Ù Ø§Ù„ÙˆØ±Ù‚Ø©:', gid);
                console.log('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©:', csvText);
                console.log('Ø§Ù„Ø£Ø³Ø·Ø±:', lines);
                console.log('Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†:', headerColumns);
                console.log('Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©:', newTeachers);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´Ø®ÙŠØµ:', error);
                showAutoImportStatus(`âŒ ÙØ´Ù„ ÙÙŠ ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}`, '#f44336', 8000);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateSheetUrlDisplay() {
            const urlDisplay = document.getElementById('currentSheetUrl');
            if (urlDisplay) {
                urlDisplay.textContent = googleSheetsUrl;
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function showImportedData() {
            updateImportedDataDisplay();
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
            const section = document.getElementById('importedDataSection');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ù„ÙØª Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡
                section.style.border = '2px solid #4caf50';
                section.style.boxShadow = '0 0 20px rgba(76, 175, 80, 0.5)';
                
                setTimeout(() => {
                    section.style.border = '1px solid rgba(255, 255, 255, 0.2)';
                    section.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.1)';
                }, 3000);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function updateImportedDataDisplay() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            document.getElementById('totalImportedTeachers').textContent = teachers.length;
            document.getElementById('totalImportedClasses').textContent = classes.length;
            document.getElementById('importedDataCount').textContent = `${teachers.length} Ù…Ø¹Ù„Ù…Ø©`;
            document.getElementById('lastUpdateTime').textContent = new Date().toLocaleTimeString('ar-SA');

            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
            updateImportedTeachersList();
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙÙˆÙ
            updateImportedClassesList();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ
            updateDataSummary();
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function updateImportedTeachersList() {
            const listContainer = document.getElementById('importedTeachersList');
            
            if (teachers.length === 0) {
                listContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: rgba(255,255,255,0.7); font-style: italic;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“‹</div>
                        <div>Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø£ÙŠ Ù…Ø¹Ù„Ù…Ø§Øª Ø¨Ø¹Ø¯</div>
                        <div style="font-size: 0.9rem; margin-top: 0.5rem;">Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ" Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª</div>
                    </div>
                `;
                return;
            }

            listContainer.innerHTML = teachers.map((teacher, index) => `
                <div style="background: rgba(76, 175, 80, 0.1); border: 1px solid rgba(76, 175, 80, 0.3); border-radius: 10px; padding: 1rem; transition: all 0.3s ease;" 
                     onmouseover="this.style.background='rgba(76, 175, 80, 0.2)'; this.style.transform='translateY(-2px)'" 
                     onmouseout="this.style.background='rgba(76, 175, 80, 0.1)'; this.style.transform='translateY(0)'">
                    
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                        <div style="width: 40px; height: 40px; background: linear-gradient(45deg, #4caf50, #81c784); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2rem;">
                            ${index + 1}
                        </div>
                        <div style="flex: 1;">
                            <div style="color: white; font-weight: 600; font-size: 1rem; margin-bottom: 0.25rem;">
                                ${teacher.name}
                            </div>
                            <div style="color: rgba(255,255,255,0.8); font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span style="background: rgba(33, 150, 243, 0.3); padding: 0.25rem 0.5rem; border-radius: 5px; font-size: 0.8rem;">
                                    ğŸ« ${teacher.class}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">
                            Ø§Ù„Ø­Ø§Ù„Ø©: ${getStatusText(teacher.status)}
                        </div>
                        <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">
                            ID: ${teacher.id}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function updateImportedClassesList() {
            const listContainer = document.getElementById('importedClassesList');
            
            if (classes.length === 0) {
                listContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: rgba(255,255,255,0.7); font-style: italic;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ«</div>
                        <div>Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠ ØµÙÙˆÙ Ø¨Ø¹Ø¯</div>
                        <div style="font-size: 0.9rem; margin-top: 0.5rem;">Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª</div>
                    </div>
                `;
                return;
            }

            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            const classLevels = {};
            classes.forEach(classItem => {
                const level = classItem.name.split('/')[0]; // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ (1ØŒ 2ØŒ 3ØŒ Ø¥Ù„Ø®)
                if (!classLevels[level]) {
                    classLevels[level] = [];
                }
                classLevels[level].push(classItem);
            });

            let html = '';
            Object.keys(classLevels).sort((a, b) => parseInt(a) - parseInt(b)).forEach(level => {
                html += `
                    <div style="grid-column: 1 / -1; margin: 1rem 0;">
                        <h6 style="color: #ffa726; font-size: 1.1rem; margin-bottom: 0.5rem; text-align: center; background: rgba(255, 167, 38, 0.1); padding: 0.5rem; border-radius: 8px;">
                            ğŸ“š Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${level}
                        </h6>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.5rem;">
                            ${classLevels[level].map(classItem => `
                                <div style="background: rgba(33, 150, 243, 0.1); border: 1px solid rgba(33, 150, 243, 0.3); border-radius: 8px; padding: 0.75rem; text-align: center; transition: all 0.3s ease;"
                                     onmouseover="this.style.background='rgba(33, 150, 243, 0.2)'; this.style.transform='scale(1.02)'" 
                                     onmouseout="this.style.background='rgba(33, 150, 243, 0.1)'; this.style.transform='scale(1)'">
                                    
                                    <div style="color: white; font-weight: 600; font-size: 1.1rem; margin-bottom: 0.5rem;">
                                        ${classItem.name}
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: rgba(255,255,255,0.8);">
                                        <span>Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…: ${classItem.dailyPoints || 0}</span>
                                        <span>ID: ${classItem.id}</span>
                                    </div>
                                    
                                    <div style="margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                                        <div style="font-size: 0.7rem; color: rgba(255,255,255,0.6);">
                                            Ø§Ù„Ù…Ø¹Ù„Ù…Ø©: ${getTeacherForClass(classItem.name)}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            listContainer.innerHTML = html;
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function updateDataSummary() {
            const summaryContainer = document.getElementById('dataSummary');
            
            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
            const statusCounts = {
                present: teachers.filter(t => t.status === 'present').length,
                absent: teachers.filter(t => t.status === 'absent').length,
                late: teachers.filter(t => t.status === 'late').length,
                excused: teachers.filter(t => t.status === 'excused').length,
                'not-recorded': teachers.filter(t => t.status === 'not-recorded').length
            };

            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙÙˆÙ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            const levelCounts = {};
            classes.forEach(classItem => {
                const level = classItem.name.split('/')[0];
                levelCounts[level] = (levelCounts[level] || 0) + 1;
            });

            // Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙÙˆÙ Ù†Ù‚Ø§Ø·Ø§Ù‹
            const topClasses = [...classes]
                .sort((a, b) => (b.dailyPoints || 0) - (a.dailyPoints || 0))
                .slice(0, 5);

            summaryContainer.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                    
                    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ± -->
                    <div style="background: rgba(76, 175, 80, 0.1); border: 1px solid rgba(76, 175, 80, 0.3); border-radius: 10px; padding: 1rem;">
                        <h6 style="color: #4caf50; margin-bottom: 1rem; text-align: center;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ±</h6>
                        <div style="space-y: 0.5rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">âœ… Ø­Ø§Ø¶Ø±Ø§Øª:</span>
                                <span style="color: #4caf50; font-weight: bold;">${statusCounts.present}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">âŒ ØºØ§Ø¦Ø¨Ø§Øª:</span>
                                <span style="color: #f44336; font-weight: bold;">${statusCounts.absent}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">â° Ù…ØªØ£Ø®Ø±Ø§Øª:</span>
                                <span style="color: #ff9800; font-weight: bold;">${statusCounts.late}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">ğŸ“‹ Ø¨Ø¹Ø°Ø±:</span>
                                <span style="color: #2196f3; font-weight: bold;">${statusCounts.excused}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">âšª Ù„Ù… ÙŠØ³Ø¬Ù„:</span>
                                <span style="color: #9e9e9e; font-weight: bold;">${statusCounts['not-recorded']}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙÙˆÙ -->
                    <div style="background: rgba(33, 150, 243, 0.1); border: 1px solid rgba(33, 150, 243, 0.3); border-radius: 10px; padding: 1rem;">
                        <h6 style="color: #2196f3; margin-bottom: 1rem; text-align: center;">ğŸ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙÙˆÙ</h6>
                        <div>
                            ${Object.keys(levelCounts).sort((a, b) => parseInt(a) - parseInt(b)).map(level => `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: rgba(255,255,255,0.9);">ğŸ“š Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${level}:</span>
                                    <span style="color: #2196f3; font-weight: bold;">${levelCounts[level]} ØµÙ</span>
                                </div>
                            `).join('')}
                            <hr style="border-color: rgba(255,255,255,0.2); margin: 0.75rem 0;">
                            <div style="display: flex; justify-content: space-between; font-weight: bold;">
                                <span style="color: white;">ğŸ“Š Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                                <span style="color: #2196f3;">${classes.length} ØµÙ</span>
                            </div>
                        </div>
                    </div>

                    <!-- Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙÙˆÙ Ù†Ù‚Ø§Ø·Ø§Ù‹ -->
                    <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); border-radius: 10px; padding: 1rem;">
                        <h6 style="color: #ffc107; margin-bottom: 1rem; text-align: center;">ğŸ† Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙÙˆÙ Ù†Ù‚Ø§Ø·Ø§Ù‹</h6>
                        <div>
                            ${topClasses.length > 0 ? topClasses.map((classItem, index) => `
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; padding: 0.25rem; background: rgba(255,255,255,0.05); border-radius: 5px;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: ${index === 0 ? '#ffd700' : index === 1 ? '#c0c0c0' : index === 2 ? '#cd7f32' : '#ffc107'}; font-weight: bold;">
                                            ${index + 1}.
                                        </span>
                                        <span style="color: white;">${classItem.name}</span>
                                    </div>
                                    <span style="color: #ffc107; font-weight: bold;">${classItem.dailyPoints || 0} Ù†Ù‚Ø·Ø©</span>
                                </div>
                            `).join('') : '<div style="text-align: center; color: rgba(255,255,255,0.7); font-style: italic;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ù‚Ø§Ø· Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯</div>'}
                        </div>
                    </div>

                    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« -->
                    <div style="background: rgba(156, 39, 176, 0.1); border: 1px solid rgba(156, 39, 176, 0.3); border-radius: 10px; padding: 1rem;">
                        <h6 style="color: #9c27b0; margin-bottom: 1rem; text-align: center;">ğŸ”„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«</h6>
                        <div style="font-size: 0.9rem;">
                            <div style="margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">ğŸ“… Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:</span><br>
                                <span style="color: #9c27b0; font-weight: bold;">${new Date().toLocaleString('ar-SA')}</span>
                            </div>
                            <div style="margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">ğŸ”— Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</span><br>
                                <span style="color: #9c27b0; font-size: 0.8rem;">Google Sheets (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</span>
                            </div>
                            <div style="margin-bottom: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.9);">â±ï¸ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«:</span><br>
                                <span style="color: #9c27b0; font-weight: bold;">ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©</span>
                            </div>
                            <div>
                                <span style="color: rgba(255,255,255,0.9);">ğŸ“Š Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…:</span><br>
                                <span style="color: #9c27b0; font-weight: bold;">Ø§Ù„Ø¥ØµØ¯Ø§Ø± 24</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø¹Ø±Ø¶ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function showDataTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.querySelectorAll('.data-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('#teachersTab, #classesTab, #summaryTab').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = btn.id === 'teachersTab' ? '#2196f3' : 
                                     btn.id === 'classesTab' ? '#9c27b0' : '#4caf50';
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
            document.getElementById(`${tabName}DataTab`).style.display = 'block';
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
            const activeBtn = document.getElementById(`${tabName}Tab`);
            activeBtn.classList.add('active');
            activeBtn.style.background = 'linear-gradient(45deg, #42a5f5, #ab47bc)';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
            if (tabName === 'teachers') {
                updateImportedTeachersList();
            } else if (tabName === 'classes') {
                updateImportedClassesList();
            } else if (tabName === 'summary') {
                updateDataSummary();
            }
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø­Ø§Ù„Ø©
        function getStatusText(status) {
            const statusTexts = {
                'present': 'âœ… Ø­Ø§Ø¶Ø±Ø©',
                'absent': 'âŒ ØºØ§Ø¦Ø¨Ø©',
                'late': 'â° Ù…ØªØ£Ø®Ø±Ø©',
                'excused': 'ğŸ“‹ Ø¨Ø¹Ø°Ø±',
                'not-recorded': 'âšª Ù„Ù… ÙŠØ³Ø¬Ù„'
            };
            return statusTexts[status] || 'â“ ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø§Ù„ØµÙ
        function getTeacherForClass(className) {
            const teacher = teachers.find(t => t.class === className);
            return teacher ? teacher.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØµÙˆÙŠØ±
        let currentStream = null;
        let currentTeacherId = null;
        let facingMode = 'user'; // 'user' Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©ØŒ 'environment' Ù„Ù„Ø®Ù„ÙÙŠØ©
        let capturedPhotoData = null;

        // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
        function editTeacherAttendance(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;
            
            const newStatus = prompt(`ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¶ÙˆØ± ${teacher.name}\n\nØ§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:\n1 - Ø­Ø§Ø¶Ø±Ø©\n2 - ØºØ§Ø¦Ø¨Ø©\n3 - Ù…ØªØ£Ø®Ø±Ø©\n4 - Ø¨Ø¹Ø°Ø±\n5 - Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„\n\nØ£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø­Ø§Ù„Ø©:`, '1');
            
            if (newStatus) {
                const statusMap = {
                    '1': 'present',
                    '2': 'absent', 
                    '3': 'late',
                    '4': 'excused',
                    '5': 'not-recorded'
                };
                
                const status = statusMap[newStatus];
                if (status) {
                    updateAttendance(teacherId, status);
                    
                    // Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
                    const note = prompt('Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):');
                    if (note) {
                        teacher.editNote = note;
                        teacher.editTime = new Date().toLocaleTimeString('ar-SA');
                    }
                    
                    alert(`ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¶ÙˆØ± ${teacher.name} Ø¨Ù†Ø¬Ø§Ø­!`);
                } else {
                    alert('Ø±Ù‚Ù… ØºÙŠØ± ØµØ­ÙŠØ­!');
                }
            }
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
        function resetTeacherAttendance(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;
            
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø¶ÙˆØ± ${teacher.name}ØŸ`)) {
                teacher.status = 'not-recorded';
                teacher.attendanceTime = null;
                teacher.photo = null;
                teacher.editNote = null;
                teacher.editTime = null;
                
                renderTeachers();
                updateStats();
                alert(`ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø¶ÙˆØ± ${teacher.name} Ø¨Ù†Ø¬Ø§Ø­!`);
            }
        }

        // ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        async function openCamera(teacherId) {
            currentTeacherId = teacherId;
            const teacher = teachers.find(t => t.id === teacherId);
            
            if (!teacher) return;
            
            document.getElementById('cameraTitle').textContent = `ØªØµÙˆÙŠØ± Ø­Ø¶ÙˆØ±: ${teacher.name}`;
            document.getElementById('cameraModal').style.display = 'flex';
            
            try {
                await startCamera();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§:', error);
                alert('ÙØ´Ù„ ÙÙŠ ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ù†Ø­ Ø§Ù„Ø¥Ø°Ù† Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§.');
                closeCameraModal();
            }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        async function startCamera() {
            try {
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª
                if (currentStream) {
                    currentStream.getTracks().forEach(track => track.stop());
                }
                
                const constraints = {
                    video: {
                        facingMode: facingMode,
                        width: { ideal: 640 },
                        height: { ideal: 480 }
                    }
                };
                
                currentStream = await navigator.mediaDevices.getUserMedia(constraints);
                const video = document.getElementById('cameraVideo');
                video.srcObject = currentStream;
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
                document.getElementById('captureBtn').style.display = 'inline-block';
                document.getElementById('switchBtn').style.display = 'inline-block';
                document.getElementById('saveBtn').style.display = 'none';
                document.getElementById('retakeBtn').style.display = 'none';
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø©
                document.getElementById('capturedImage').style.display = 'none';
                video.style.display = 'block';
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§:', error);
                throw error;
            }
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        async function switchCamera() {
            facingMode = facingMode === 'user' ? 'environment' : 'user';
            await startCamera();
        }

        // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø©
        function capturePhoto() {
            const video = document.getElementById('cameraVideo');
            const canvas = document.getElementById('cameraCanvas');
            const capturedImage = document.getElementById('capturedImage');
            
            // ØªØ¹ÙŠÙŠÙ† Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Ø±Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            
            // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØµÙˆØ±Ø©
            capturedPhotoData = canvas.toDataURL('image/jpeg', 0.8);
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø©
            capturedImage.src = capturedPhotoData;
            capturedImage.style.display = 'block';
            video.style.display = 'none';
            
            // ØªØºÙŠÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
            document.getElementById('captureBtn').style.display = 'none';
            document.getElementById('switchBtn').style.display = 'none';
            document.getElementById('saveBtn').style.display = 'inline-block';
            document.getElementById('retakeBtn').style.display = 'inline-block';
        }

        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
        function retakePhoto() {
            capturedPhotoData = null;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
            document.getElementById('cameraVideo').style.display = 'block';
            document.getElementById('capturedImage').style.display = 'none';
            
            // ØªØºÙŠÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
            document.getElementById('captureBtn').style.display = 'inline-block';
            document.getElementById('switchBtn').style.display = 'inline-block';
            document.getElementById('saveBtn').style.display = 'none';
            document.getElementById('retakeBtn').style.display = 'none';
        }

        // Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©
        function savePhoto() {
            if (!capturedPhotoData || !currentTeacherId) return;
            
            const teacher = teachers.find(t => t.id === currentTeacherId);
            if (!teacher) return;
            
            // Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
            teacher.photo = capturedPhotoData;
            teacher.photoTime = new Date().toLocaleTimeString('ar-SA');
            
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø­Ø¶ÙˆØ± Ù…Ø³Ø¬Ù„ØŒ ØªØ³Ø¬ÙŠÙ„ ÙƒØ­Ø§Ø¶Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            if (teacher.status === 'not-recorded') {
                updateAttendance(currentTeacherId, 'present');
            }
            
            alert(`ØªÙ… Ø­ÙØ¸ ØµÙˆØ±Ø© ${teacher.name} Ø¨Ù†Ø¬Ø§Ø­!`);
            closeCameraModal();
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        function closeCameraModal() {
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
                currentStream = null;
            }
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø©
            document.getElementById('cameraModal').style.display = 'none';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
            currentTeacherId = null;
            capturedPhotoData = null;
            facingMode = 'user';
        }

        // Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø©
        function viewTeacherPhoto(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher || !teacher.photo) return;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 4000;
                cursor: pointer;
            `;
            
            modal.innerHTML = `
                <div style="max-width: 90%; max-height: 90%; text-align: center;">
                    <h3 style="color: white; margin-bottom: 1rem;">${teacher.name}</h3>
                    <img src="${teacher.photo}" style="max-width: 100%; max-height: 80vh; border-radius: 10px; box-shadow: 0 0 30px rgba(255,255,255,0.3);">
                    <div style="color: white; margin-top: 1rem; font-size: 0.9rem;">
                        ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©: ${teacher.photoTime || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                    </div>
                    <div style="color: rgba(255,255,255,0.7); margin-top: 0.5rem; font-size: 0.8rem;">
                        Ø§Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ù„Ù„Ø¥ØºÙ„Ø§Ù‚
                    </div>
                </div>
            `;
            
            modal.onclick = () => document.body.removeChild(modal);
            document.body.appendChild(modal);
        }

        // ØªØ­Ø¯ÙŠØ« ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¥Ø¶Ø§ÙØ© Ø®Ø§ØµÙŠØ© Ø§Ù„ØµÙˆØ±
        function initializeTeachersWithPhotos() {
            teachers.forEach(teacher => {
                if (!teacher.photo) teacher.photo = null;
                if (!teacher.photoTime) teacher.photoTime = null;
                if (!teacher.editNote) teacher.editNote = null;
                if (!teacher.editTime) teacher.editTime = null;
            });
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', () => {
            initializeSystem();
            updateSheetUrlDisplay();
            initializeTeachersWithPhotos();
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setInterval(() => {
                updateImportedDataDisplay();
            }, 60000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'982357ab34d5127c',t:'MTc1ODM5MjQ4Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
